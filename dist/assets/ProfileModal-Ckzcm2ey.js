import{e as O,j as e,r as i,a as R,q as V,u as P,ac as I,ad as q,d as L,B as M}from"./index-DgAd_cHG.js";import{p as g}from"./profileData-DThhwKJj.js";import{A as F}from"./Avatar-CF0DRMKt.js";const Y=O(e.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit"),T=O(e.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"}),"Mail"),J=["https://cdn.jsdelivr.net/gh/alohe/avatars/png/vibrent_20.png","https://cdn.jsdelivr.net/gh/alohe/avatars/png/upstream_17.png","https://cdn.jsdelivr.net/gh/alohe/avatars/png/teams_1.png","https://cdn.jsdelivr.net/gh/alohe/avatars/png/upstream_19.png","https://cdn.jsdelivr.net/gh/alohe/avatars/png/upstream_20.png","https://cdn.jsdelivr.net/gh/alohe/avatars/png/toon_7.png","https://cdn.jsdelivr.net/gh/alohe/avatars/png/toon_6.png","https://cdn.jsdelivr.net/gh/alohe/avatars/png/vibrent_17.png"],K=g.specialization,Q=g.yearofgraduation,X=c=>{const l=g.programs.find(t=>t.name===c),x=(l==null?void 0:l.maxSemester)||0;return Array.from({length:x},(t,a)=>`${a+1}`)},Z=g.programs,oe=({onClose:c})=>{var C;const l=i.useRef({}),x=s=>{const r=l.current[`${s}-input`];if(!r)return!1;const o=r.getBoundingClientRect();return window.innerHeight-o.bottom<200},t=R(s=>s.auth.user),[a,m]=i.useState({yearOfGraduation:"",university:"",program:"",semester:"",specialisation:""}),[f,w]=i.useState((t==null?void 0:t.avatar)||""),[z,v]=i.useState(!1),[ee,j]=i.useState(""),[y,N]=i.useState(!1),[k,U]=i.useState([]),[B,u]=i.useState(!1),[d,b]=i.useState({program:!1,specialisation:!1,yearOfGraduation:!1,semester:!1}),E=V();i.useEffect(()=>{t&&(m({yearOfGraduation:t.yearOfGraduation||"",university:t.university||"",program:t.program||"",semester:t.semester||"",specialisation:t.specialisation||""}),w(t.avatar||""))},[t]);const G=s=>{s.target.name==="university"&&(m({...a,[s.target.name]:s.target.value}),A(s.target.value),u(s.target.value.length>0),console.log("Show suggestions:",s.target.value.length>0))},A=async s=>{if(s)try{const o=(await L.get(`${M}/api/university/${s}`,{withCredentials:!0})).data.map(n=>n.name);U(o)}catch(r){console.error("Error fetching universities:",r)}},_=s=>{m({...a,university:s}),u(!1)},h=(s,r)=>{m({...a,[s]:r}),b({...d,[s]:!1})},p=s=>{const r=Object.keys(d).reduce((o,n)=>(o[n]=n===s?!d[n]:!1,o),{});b(r),u(!1)},S=s=>{const r=document.querySelectorAll(".dropdown-container");let o=!1;r.forEach(n=>{n.contains(s.target)&&(o=!0)}),o||(b({program:!1,specialisation:!1,yearOfGraduation:!1,semester:!1}),u(!1))};i.useEffect(()=>(document.addEventListener("mousedown",S),()=>{document.removeEventListener("mousedown",S)}),[]);const D=s=>{w(s),v(!1)},H=async s=>{var r,o;if(s.preventDefault(),!(t!=null&&t._id))return j("User not authenticated");try{N(!0);const n={...a,id:t._id,avatar:f};await L.put(`${M}/api/profile/complete`,n,{withCredentials:!0}),window.location.reload()}catch(n){j(((o=(r=n.response)==null?void 0:r.data)==null?void 0:o.error)||"Update failed. Please try again.")}finally{N(!1)}},W=P(),$=()=>{try{console.log("Btn clicked"),W(I(q.get("token"))),E("/")}catch(s){console.log(s,"logout")}};return e.jsxs("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4",children:[e.jsxs("div",{className:"w-full max-w-2xl overflow-visible bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{style:{background:"linear-gradient(90deg, #db5602 0%, #e67a34 50%, #f9a03f 100%)"},className:`relative h-20
`,children:[e.jsx("div",{className:"absolute -bottom-12 left-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(F,{src:f||(t==null?void 0:t.avatar)||"https://randomuser.me/api/portraits/men/1.jpg",sx:{width:96,height:96,border:"4px solid white",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},className:"w-24 h-24 rounded-full object-cover border-4 border-white shadow-md",children:(C=t==null?void 0:t.name)==null?void 0:C.charAt(0).toUpperCase()}),e.jsx("button",{onClick:()=>v(!0),className:"absolute bottom-0 right-0 bg-white p-1 rounded-full shadow-md",children:e.jsx(Y,{className:"text-[#db5602]",fontSize:"small"})})]})}),e.jsx("button",{className:"absolute top-4 right-4 text-white hover:text-gray-200",onClick:c,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"pt-16 px-6 pb-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:(t==null?void 0:t.name)||"Thomas Holmes"}),e.jsxs("p",{className:"text-[#7e7e7e]",children:[e.jsx("span",{className:"mr-1",children:e.jsx(T,{className:"text-[#db5602]",fontSize:"small"})}),(t==null?void 0:t.email)||"heythomas@gmail.com"]})]}),e.jsxs("button",{className:"absolute top-4 left-4 flex items-center gap-2 text-white hover:text-gray-200 text-sm",onClick:()=>$(),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]}),e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1 relative dropdown-container",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["University",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",name:"university",value:a.university,onChange:G,required:!0,placeholder:"Search for your university",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#db5602] focus:border-transparent"}),B&&k.length>0&&e.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg max-h-[200px] overflow-auto",children:k.map((s,r)=>e.jsx("div",{className:"px-4 py-2 hover:bg-orange-50 cursor-pointer",onClick:()=>_(s),children:s},r))})]})]}),e.jsxs("div",{className:"space-y-1 relative dropdown-container",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Program",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#db5602] focus:border-transparent bg-white cursor-pointer flex items-center truncate",onClick:()=>p("program"),children:[e.jsx("span",{className:"truncate flex-1",children:a.program||"Select your program"}),e.jsx("svg",{className:"h-5 w-5 text-gray-400 ml-2 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),d.program&&e.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg max-h-[200px] overflow-y-auto",children:Z.map((s,r)=>e.jsx("div",{className:"px-4 py-2 hover:bg-orange-50 cursor-pointer",onClick:()=>h("program",s.name),children:s.name},r))})]})]}),e.jsxs("div",{className:"space-y-1 relative dropdown-container",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Specialisation",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#db5602] focus:border-transparent bg-white cursor-pointer flex items-center truncate",onClick:()=>p("specialisation"),children:[e.jsx("span",{className:"truncate flex-1",children:a.specialisation||"Select your specialisation"}),e.jsx("svg",{className:"h-5 w-5 text-gray-400 ml-2 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),d.specialisation&&e.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg max-h-[130px] overflow-auto",children:K.map((s,r)=>e.jsx("div",{className:"px-4 py-2 hover:bg-orange-50 cursor-pointer",onClick:()=>h("specialisation",s),children:s},r))})]})]}),e.jsxs("div",{className:"space-y-1 relative dropdown-container",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Semester"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#db5602] focus:border-transparent bg-white cursor-pointer flex justify-between items-center",onClick:()=>p("semester"),children:[a.semester||"Select your semester",e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),d.semester&&e.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-md shadow-lg max-h-[130px] overflow-auto",children:X(a.program).map((s,r)=>e.jsx("div",{className:"px-4 py-2 hover:bg-orange-50 cursor-pointer",onClick:()=>h("semester",s),children:s},r))})]})]}),e.jsxs("div",{className:"space-y-1 relative dropdown-container",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Graduation Year",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#db5602] focus:border-transparent bg-white cursor-pointer flex justify-between items-center truncate overflow-x-auto whitespace-nowrap",onClick:()=>p("yearOfGraduation"),ref:s=>l.current["yearOfGraduation-input"]=s,children:[a.yearOfGraduation||"Select graduation year",e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),d.yearOfGraduation&&e.jsx("div",{className:`absolute z-10 ${x("yearOfGraduation")?"bottom-full mb-1":"mt-1"} w-full bg-white border border-gray-300 rounded-md shadow-lg max-h-[130px] overflow-y-auto`,ref:s=>l.current["yearOfGraduation-dropdown"]=s,children:Q.map((s,r)=>e.jsx("div",{className:"px-4 py-2 hover:bg-orange-50 cursor-pointer",onClick:()=>h("yearOfGraduation",s),children:s},r))})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t border-gray-200 mt-6",children:[e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition",children:"Discard"}),e.jsx("button",{type:"submit",disabled:y,className:"px-4 py-2 text-sm font-medium text-white bg-[#db5602] hover:bg-[#b34600] rounded-md transition flex items-center justify-center",children:y?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})]})]})]})]}),z&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full shadow-xl border border-orange-100",children:[e.jsx("h3",{className:"text-xl font-bold text-center mb-4 text-[#db5602]",children:"Choose Your Avatar"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:J.map(s=>e.jsx("img",{src:s,alt:"avatar",onClick:()=>D(s),className:`w-16 h-16 rounded-full cursor-pointer transition-all ${f===s?"ring-4 ring-[#db5602] scale-110":"hover:ring-2 hover:ring-[#db5602]/50"}`},s))}),e.jsx("button",{onClick:()=>v(!1),className:"mt-6 w-full py-2 bg-orange-50 hover:bg-orange-100 rounded-lg transition text-[#db5602] font-medium border border-orange-100",children:"Close"})]})})]})};export{Y as E,oe as P};
