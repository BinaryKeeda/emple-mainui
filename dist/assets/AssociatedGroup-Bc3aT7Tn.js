import{r as y,j as e,d as v,B as w,a as _,i as z,a8 as q,b as C}from"./index-DgAd_cHG.js";import{u as k}from"./useQuery-BoYP5h9i.js";import{L as P}from"./Lock-BRAJ5sup.js";import{a as L}from"./useGroupData-7vSXx7KO.js";import"./api-C0dE17cz.js";function A({sectionId:c,isGroup:m=!1}){const[s,n]=y.useState(1),i=10,b=y.useMemo(()=>({sectionId:c,isGroup:m,page:s,limit:i}),[c,m,s,i]),x=async({queryKey:t})=>{const[N,d]=t,f=new URLSearchParams(d).toString();return(await v.get(`${w}/api/data/user/quiz?${f}`,{withCredentials:!0})).data},{data:r,isLoading:h,isError:p,error:g}=k({queryKey:["quizzes",b],queryFn:x,keepPreviousData:!0,staleTime:1e3*60*5});if(h)return e.jsx("div",{children:"Loading quizzes..."});if(p)return e.jsx("div",{className:"text-red-500",children:g.message});const j=(r==null?void 0:r.quizzes)||[],l=(r==null?void 0:r.total)||0,o=Math.ceil(l/i),u=()=>{s>1&&n(s-1)},a=()=>{s<o&&n(s+1)};return e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"relative px-5 md:px-4 flex flex-col w-full overflow-x-auto dark:text-white bg-white shadow-md rounded-lg",children:[e.jsxs("table",{className:"w-full text-left table-auto min-w-max",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-support",children:[e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Title"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Difficulty"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Category"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Marks"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Attempt"})]})}),e.jsx("tbody",{children:j.map(t=>e.jsxs("tr",{className:"bg-primary",children:[e.jsx("td",{className:"p-4",children:t.title}),e.jsx("td",{className:"p-4",children:t.difficulty}),e.jsx("td",{className:"p-4",children:t.category}),e.jsx("td",{className:"p-4",children:t.marks}),e.jsx("td",{className:"p-4",children:t.locked?e.jsx(P,{}):e.jsx("a",{href:`/user/quiz/${t.slug}`,className:"text-xs bg-sky-600 hover:bg-sky-500 text-white py-1 px-3 rounded-full",children:"Attempt"})})]},t._id))})]}),l>i&&e.jsxs("div",{className:"flex bg-support justify-between items-center px-4 py-3",children:[e.jsxs("div",{className:"text-sm",children:["Showing ",e.jsxs("b",{children:[(s-1)*i+1,"-",Math.min(s*i,l)]})," of ",l]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:u,disabled:s===1,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal bg-primary border border-slate-200 rounded hover:border-slate-400 disabled:opacity-50",children:"Prev"}),e.jsx("button",{onClick:a,disabled:s===o,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal bg-primary border border-slate-200 rounded hover:border-slate-400 disabled:opacity-50",children:"Next"})]})]})]})})}function D({sectionId:c,isGroup:m=!1}){const[s,n]=y.useState(1),i=10,b=y.useMemo(()=>({sectionId:c,page:s,limit:i,isGroup:m}),[c,s,i]),x=async({queryKey:t})=>{const[N,d]=t,f=new URLSearchParams(d).toString();return(await v.get(`${w}/api/data/user/test?${f}`,{withCredentials:!0})).data},{data:r,isLoading:h,isError:p,error:g}=k({queryKey:["tests",b],queryFn:x,keepPreviousData:!0,staleTime:1e3*60*5});if(h)return e.jsx("div",{children:"Loading tests..."});if(p)return e.jsx("div",{className:"text-red-500",children:g.message});const j=(r==null?void 0:r.tests)||[],l=(r==null?void 0:r.total)||0,o=Math.ceil(l/i),u=()=>{s>1&&n(s-1)},a=()=>{s<o&&n(s+1)};return e.jsx("div",{className:"",children:e.jsxs("div",{className:"relative flex flex-col w-full overflow-x-auto dark:text-white bg-white shadow-md rounded-lg",children:[e.jsxs("table",{className:"w-full text-left table-auto min-w-max",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-support",children:[e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Title"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Description"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Duration"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Attempts"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Attempt"})]})}),e.jsx("tbody",{children:j.map(t=>e.jsxs("tr",{className:"bg-primary",children:[e.jsx("td",{className:"p-4",children:t.name}),e.jsx("td",{className:"p-4",children:t.description}),e.jsxs("td",{className:"p-4",children:[t.duration," min."]}),e.jsxs("td",{className:"p-4",children:[t.attempts," / ",t.maxAttempts||1]}),e.jsx("td",{className:"p-4",children:t.attempts===0?e.jsx("a",{href:`/user/test/${t.slug}`,className:"text-xs bg-sky-600 hover:bg-sky-500 text-white py-1 px-3 rounded-full",children:"Attempt"}):e.jsx(P,{})})]},t._id))})]}),l>i&&e.jsxs("div",{className:"flex bg-support justify-between items-center px-4 py-3",children:[e.jsxs("div",{className:"text-sm",children:["Showing"," ",e.jsxs("b",{children:[(s-1)*i+1,"-",Math.min(s*i,l)]})," ","of ",l]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:u,disabled:s===1,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal bg-primary border border-slate-200 rounded hover:border-slate-400 disabled:opacity-50",children:"Prev"}),e.jsx("button",{onClick:a,disabled:s===o,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal bg-primary border border-slate-200 rounded hover:border-slate-400 disabled:opacity-50",children:"Next"})]})]})]})})}function Q(){var l,o,u;const{user:c}=_(a=>a.auth),m=c._id,{id:s}=z(),[n,i]=q(),b=n.get("section"),x=n.get("tab"),{data:r,error:h}=L({userId:m});if(h)return e.jsxs("p",{className:"text-red-500",children:["Error: ",JSON.stringify(h)]});if(!r)return e.jsx("p",{className:"text-gray-400",children:"Loading..."});const p=(o=(l=r==null?void 0:r.data)==null?void 0:l.find(a=>a.section._id===b))==null?void 0:o.section,g=({section:a})=>{const t=[{head:"Quiz",type:"quiz",image:a.quizImage||"https://res.cloudinary.com/drzyrq7d5/image/upload/v1757593501/quiz_ptz1ft.png"},{head:"Test Series",type:"test",image:a.testImage||"https://res.cloudinary.com/dkybjjott/image/upload/v1750263010/WhatsApp_Image_2025-06-11_at_21.12.06-removebg-preview_losyhk.png"}],N=d=>{i({section:a._id,tab:d})};return x==="quiz"?e.jsx(A,{sectionId:a._id,isGroup:!0}):x==="test"?e.jsx(D,{sectionId:a._id,isGroup:!0}):e.jsx("div",{className:"flex gap-5",children:t.map((d,f)=>e.jsxs("div",{onClick:()=>N(d.type),className:"flex items-center p-5 min-w-96 cursor-pointer flex-col overflow-hidden rounded-[22px] border border-gray-100 bg-primary shadow-lg transition-all duration-300 hover:scale-[1.02] hover:shadow-2xl dark:border-gray-700 dark:shadow-black/40",children:[e.jsx("img",{src:d.image,alt:d.head,className:"h-[200px] w-full object-contain"}),e.jsx("hr",{className:"mt-5 mx-5 w-52"}),e.jsx("div",{className:"flex flex-1 items-center justify-center p-5",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:d.head})})]},f))})},j=({section:a})=>e.jsxs(C,{to:`?section=${a._id}`,className:`
        bg-[#242424] text-white rounded-lg shadow-lg
        p-4 hover:bg-[#1c1c1c] transition-all
        flex flex-col justify-between
      `,children:[e.jsx("img",{src:a.image,className:"h-32",alt:""}),e.jsx("h3",{className:"text-lg font-semibold mt-2 rounded-md mb-2",children:a.name}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Click to open"})]});return e.jsx("div",{className:"p-4",children:p?e.jsx(g,{section:p}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:(u=r==null?void 0:r.data)==null?void 0:u.map(a=>e.jsx(j,{section:a.section},a.section._id))})})}export{Q as default};
