import{w as Y,v as ee,r as b,x as re,aG as w,z as ae,y as A,j as a,aD as l,A as te,ao as oe,aE as ie,h as ne,e as se,d as le,B as ce,R as de,bd as ge,u as pe,c as me,b as v,o as he,I as S,al as ue,am as xe}from"./index-CjXME-GI.js";import{u as fe,G as ve}from"./api-LuIIMp2u.js";import{D as be}from"./Drawer-BOiorkP4.js";import{D as _}from"./Divider-tX2HxF6T.js";import{u as ye}from"./useQuery-CzaQtCzi.js";import{C as Oe}from"./Coin-CljQiwPF.js";import{S as je}from"./ShortText-B-MSH17c.js";import{T as Ce}from"./Tooltip-DBVebKbS.js";import{u as F}from"./usePreviousProps-jFWskjC-.js";import{P as Ne}from"./PowerSettingsNew-BRRsBoBf.js";function Re(r){const{badgeContent:e,invisible:t=!1,max:i=99,showZero:d=!1}=r,c=F({badgeContent:e,max:i});let s=t;t===!1&&e===0&&!d&&(s=!0);const{badgeContent:o,max:n=i}=s?c:r,g=o&&Number(o)>n?`${n}+`:o;return{badgeContent:o,invisible:s,max:n,displayValue:g}}function Be(r){return ee("MuiBadge",r)}const m=Y("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),C=10,N=4,Pe=r=>{const{color:e,anchorOrigin:t,invisible:i,overlap:d,variant:c,classes:s={}}=r,o={root:["root"],badge:["badge",c,i&&"invisible",`anchorOrigin${l(t.vertical)}${l(t.horizontal)}`,`anchorOrigin${l(t.vertical)}${l(t.horizontal)}${l(d)}`,`overlap${l(d)}`,e!=="default"&&`color${l(e)}`]};return te(o,Be,s)},Te=A("span",{name:"MuiBadge",slot:"Root",overridesResolver:(r,e)=>e.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),$e=A("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(r,e)=>{const{ownerState:t}=r;return[e.badge,e[t.variant],e[`anchorOrigin${l(t.anchorOrigin.vertical)}${l(t.anchorOrigin.horizontal)}${l(t.overlap)}`],t.color!=="default"&&e[`color${l(t.color)}`],t.invisible&&e.invisible]}})(oe(({theme:r})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:r.typography.fontFamily,fontWeight:r.typography.fontWeightMedium,fontSize:r.typography.pxToRem(12),minWidth:C*2,lineHeight:1,padding:"0 6px",height:C*2,borderRadius:C,zIndex:1,transition:r.transitions.create("transform",{easing:r.transitions.easing.easeInOut,duration:r.transitions.duration.enteringScreen}),variants:[...Object.entries(r.palette).filter(ie(["contrastText"])).map(([e])=>({props:{color:e},style:{backgroundColor:(r.vars||r).palette[e].main,color:(r.vars||r).palette[e].contrastText}})),{props:{variant:"dot"},style:{borderRadius:N,height:N*2,minWidth:N*2,padding:0}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${m.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${m.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${m.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${m.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${m.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${m.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${m.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${m.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:r.transitions.create("transform",{easing:r.transitions.easing.easeInOut,duration:r.transitions.duration.leavingScreen})}}]})));function L(r){return{vertical:(r==null?void 0:r.vertical)??"top",horizontal:(r==null?void 0:r.horizontal)??"right"}}const ze=b.forwardRef(function(e,t){const i=re({props:e,name:"MuiBadge"}),{anchorOrigin:d,className:c,classes:s,component:o,components:n={},componentsProps:g={},children:p,overlap:x="rectangular",color:f="default",invisible:R=!1,max:y=99,badgeContent:B,slots:h,slotProps:u,showZero:P=!1,variant:O="standard",...U}=i,{badgeContent:T,invisible:E,max:M,displayValue:H}=Re({max:y,invisible:R,badgeContent:B,showZero:P}),Z=F({anchorOrigin:L(d),color:f,overlap:x,variant:O,badgeContent:B}),$=E||T==null&&O!=="dot",{color:V=f,overlap:G=x,anchorOrigin:W,variant:z=O}=$?Z:i,q=L(W),D=z!=="dot"?H:void 0,j={...i,badgeContent:T,invisible:$,max:M,displayValue:D,showZero:P,anchorOrigin:q,color:V,overlap:G,variant:z},I=Pe(j),k={slots:{root:(h==null?void 0:h.root)??n.Root,badge:(h==null?void 0:h.badge)??n.Badge},slotProps:{root:(u==null?void 0:u.root)??g.root,badge:(u==null?void 0:u.badge)??g.badge}},[Q,K]=w("root",{elementType:Te,externalForwardedProps:{...k,...U},ownerState:j,className:ae(I.root,c),ref:t,additionalProps:{as:o}}),[J,X]=w("badge",{elementType:$e,externalForwardedProps:k,ownerState:j,className:I.badge});return a.jsxs(Q,{...K,children:[p,a.jsx(J,{...X,children:D})]})}),De=ne("Cart20Regular","20",["M3 3.5c0-.28.22-.5.5-.5h.44c.72 0 1.14.47 1.38.94.17.32.29.72.39 1.06H16a1 1 0 0 1 .96 1.27l-1.5 5.28A2 2 0 0 1 13.55 13H8.46a2 2 0 0 1-1.93-1.47L5.9 9.17l-.01-.03-1.03-3.5-.1-.33a5.2 5.2 0 0 0-.32-.91c-.16-.31-.3-.4-.5-.4H3.5a.5.5 0 0 1-.5-.5Zm3.84 5.37.66 2.4a1 1 0 0 0 .96.73h5.08a1 1 0 0 0 .96-.73L16 6H6l.84 2.87ZM10 15.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm-1 0a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0Zm6 0a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm-1 0a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0Z"]),Ie=se(a.jsx("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"}),"Notifications"),ke="#1d1e20",we=async r=>(await fe.get(ve.GET_USER_INVITE+r)).data,Se=({userId:r})=>ye({queryKey:["inviteData",r],queryFn:()=>we(r),onSuccess:(e,t,i)=>{i.queryClient.invalidateQueries(["inviteData",r]),i.queryClient.invalidateQueries(["groupData",r])}});function Le({notificationOpen:r,setNotificationOpen:e,data:t,userId:i,refreshInvites:d}){var s;const c=async(o,n,g)=>{try{await le.post(ce+"/api/data/invites/respond",{inviteId:o,accept:n==="accept",section:g},{withCredentials:!0}),window.location.reload()}catch(p){console.error("Error responding to invite:",p)}};return a.jsx(be,{anchor:"right",open:r,onClose:()=>e(!1),children:a.jsxs("div",{className:"w-80 p-4",children:[a.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Notifications"}),a.jsx(_,{className:"mb-2"}),a.jsx("ul",{className:"space-y-4 mt-3",children:(s=t==null?void 0:t.data)!=null&&s.length?t.data.map(o=>{var n;return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl shadow-sm border",children:[a.jsxs("div",{className:"text-sm",children:[a.jsxs("p",{className:"font-medium",children:[(n=o.invitedBy)==null?void 0:n.name," invited you to join a group"]}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Role: ",o.role," ·"," ",new Date(o.createdAt).toLocaleString()]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>c(o._id,"accept",o.sectionId),className:"px-2 py-1 text-xs rounded-lg bg-green-500 text-white hover:bg-green-600",children:"✅"}),a.jsx("button",{onClick:()=>c(o._id,"reject",o.sectionId),className:"px-2 py-1 text-xs rounded-lg bg-red-500 text-white hover:bg-red-600",children:"❌"})]})]},o._id)}):a.jsx("li",{className:"text-sm text-gray-500",children:"No pending invites"})})]})})}const We=de.memo(({user:r,menuOpen:e,setMenuOpen:t})=>{const{toggleTheme:i,theme:d}=b.useContext(ge),c=pe(),[s,o]=b.useState(!1),[n,g]=b.useState(0),{data:p}=Se(r?{userId:r._id}:{}),x=()=>{try{c(ue(xe.get("token")))}catch(y){console.log(y,"logout")}},f=()=>{o(!0),g(0)},{enqueueSnackbar:R}=me();return a.jsxs(a.Fragment,{children:[a.jsx("header",{className:"relative h-[59px]",children:a.jsxs("nav",{className:`fixed shadow-sm bg-white dark:bg-support dark:text-gray-50 bg-blend-difference text-gray-600 h-[59px] items-center pr-5 pl-2 flex justify-between z-40 w-full top-0 dark:bg-[${ke}]`,children:[a.jsx("div",{className:"lg:hidden",children:a.jsx(je,{onClick:()=>t(!e)})}),a.jsx("div",{className:"flex md:ml-[100px] gap-1 items-center",children:a.jsx(v,{to:"/",children:a.jsx("img",{src:he,className:"h-10",alt:"Logo"})})}),a.jsxs("div",{className:"flex items-center gap-3",children:[(r==null?void 0:r.coins)&&a.jsxs("div",{className:"flex gap-1 rounded-lg items-center",children:[a.jsx(Oe,{}),a.jsx("div",{className:"text-sm",children:a.jsx("span",{children:r==null?void 0:r.coins})})]}),a.jsx(Ce,{title:"But More Coins",sx:{cursor:"pointer"},children:a.jsx(v,{to:"/user/coins-add",children:a.jsx(De,{style:{cursor:"pointer"}})})}),r?a.jsxs(a.Fragment,{children:[a.jsx(S,{"aria-label":"notifications",onClick:f,children:a.jsxs(ze,{badgeContent:n,color:"error",sx:{position:"relative"},overlap:"circular",children:[a.jsx(Ie,{}),a.jsx("span",{className:"text-xs bg-red-500 text-white -right-2  h-4 rounded-full absolute w-4",children:JSON.stringify(p==null?void 0:p.data.length)||0})]})}),a.jsx(S,{onClick:x,children:a.jsx(Ne,{})})]}):a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(v,{to:"/login",className:"text-sm font-medium hover:underline",children:"Login"}),a.jsx(_,{orientation:"vertical",flexItem:!0,sx:{bgcolor:"grey.500"}}),a.jsx(v,{to:"/register",className:"text-sm font-medium hover:underline",children:"Signup"})]})]})]})}),a.jsx(Le,{data:p,userId:r==null?void 0:r._id,notificationOpen:s,setNotificationOpen:o})]})});export{We as H};
