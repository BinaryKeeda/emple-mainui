import{r as y,j as e,d as v,B as w,a as _,i as C,a8 as z,b as q}from"./index-B9lI-E5Z.js";import{a as L}from"./useGroupData-npIsXjmE.js";import{u as k}from"./useQuery-DK9cev7l.js";import{L as P}from"./Lock-BxfgSlWq.js";import"./api-B9zoAOxA.js";function A({sectionId:d,isGroup:x=!1}){const[s,o]=y.useState(1),i=10,b=y.useMemo(()=>({sectionId:d,isGroup:x,page:s,limit:i}),[d,x,s,i]),h=async({queryKey:t})=>{const[N,n]=t,f=new URLSearchParams(n).toString();return(await v.get(`${w}/api/data/user/quiz?${f}`,{withCredentials:!0})).data},{data:r,isLoading:p,isError:m,error:j}=k({queryKey:["quizzes",b],queryFn:h,keepPreviousData:!0,staleTime:1e3*60*5});if(p)return e.jsx("div",{children:"Loading quizzes..."});if(m)return e.jsx("div",{className:"text-red-500",children:j.message});const g=(r==null?void 0:r.quizzes)||[],l=(r==null?void 0:r.total)||0,c=Math.ceil(l/i),u=()=>{s>1&&o(s-1)},a=()=>{s<c&&o(s+1)};return e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"relative px-5 md:px-4 flex flex-col w-full overflow-x-auto dark:text-white bg-white shadow-md rounded-lg",children:[e.jsxs("table",{className:"w-full text-left table-auto min-w-max",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-support",children:[e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Title"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Difficulty"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Category"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Marks"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Attempt"})]})}),e.jsx("tbody",{children:g.map(t=>e.jsxs("tr",{className:"bg-primary",children:[e.jsx("td",{className:"p-4",children:t.title}),e.jsx("td",{className:"p-4",children:t.difficulty}),e.jsx("td",{className:"p-4",children:t.category}),e.jsx("td",{className:"p-4",children:t.marks}),e.jsx("td",{className:"p-4",children:t.locked?e.jsx(P,{}):e.jsx("a",{href:`/user/quiz/${t.slug}`,className:"text-xs bg-sky-600 hover:bg-sky-500 text-white py-1 px-3 rounded-full",children:"Attempt"})})]},t._id))})]}),l>i&&e.jsxs("div",{className:"flex bg-support justify-between items-center px-4 py-3",children:[e.jsxs("div",{className:"text-sm",children:["Showing ",e.jsxs("b",{children:[(s-1)*i+1,"-",Math.min(s*i,l)]})," of ",l]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:u,disabled:s===1,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal bg-primary border border-slate-200 rounded hover:border-slate-400 disabled:opacity-50",children:"Prev"}),e.jsx("button",{onClick:a,disabled:s===c,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal bg-primary border border-slate-200 rounded hover:border-slate-400 disabled:opacity-50",children:"Next"})]})]})]})})}function D({sectionId:d,isGroup:x=!1}){const[s,o]=y.useState(1),i=10,b=y.useMemo(()=>({sectionId:d,page:s,limit:i,isGroup:x}),[d,s,i]),h=async({queryKey:t})=>{const[N,n]=t,f=new URLSearchParams(n).toString();return(await v.get(`${w}/api/data/user/test?${f}`,{withCredentials:!0})).data},{data:r,isLoading:p,isError:m,error:j}=k({queryKey:["tests",b],queryFn:h,keepPreviousData:!0,staleTime:1e3*60*5});if(p)return e.jsx("div",{children:"Loading tests..."});if(m)return e.jsx("div",{className:"text-red-500",children:j.message});const g=(r==null?void 0:r.tests)||[],l=(r==null?void 0:r.total)||0,c=Math.ceil(l/i),u=()=>{s>1&&o(s-1)},a=()=>{s<c&&o(s+1)};return e.jsx("div",{className:"",children:e.jsxs("div",{className:"relative flex flex-col w-full overflow-x-auto dark:text-white bg-white shadow-md rounded-lg",children:[e.jsxs("table",{className:"w-full text-left table-auto min-w-max",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-support",children:[e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Title"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Description"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Duration"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Attempts"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Attempt"})]})}),e.jsx("tbody",{children:g.map(t=>e.jsxs("tr",{className:"bg-primary",children:[e.jsx("td",{className:"p-4",children:t.name}),e.jsx("td",{className:"p-4",children:t.description}),e.jsxs("td",{className:"p-4",children:[t.duration," min."]}),e.jsxs("td",{className:"p-4",children:[t.attempts," / ",t.maxAttempts||1]}),e.jsx("td",{className:"p-4",children:t.attempts===0?e.jsx("a",{href:`/user/test/${t.slug}`,className:"text-xs bg-sky-600 hover:bg-sky-500 text-white py-1 px-3 rounded-full",children:"Attempt"}):e.jsx(P,{})})]},t._id))})]}),l>i&&e.jsxs("div",{className:"flex bg-support justify-between items-center px-4 py-3",children:[e.jsxs("div",{className:"text-sm",children:["Showing"," ",e.jsxs("b",{children:[(s-1)*i+1,"-",Math.min(s*i,l)]})," ","of ",l]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:u,disabled:s===1,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal bg-primary border border-slate-200 rounded hover:border-slate-400 disabled:opacity-50",children:"Prev"}),e.jsx("button",{onClick:a,disabled:s===c,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal bg-primary border border-slate-200 rounded hover:border-slate-400 disabled:opacity-50",children:"Next"})]})]})]})})}function F(){var l,c,u;const{user:d}=_(a=>a.auth),x=d._id,{id:s}=C(),[o,i]=z(),b=o.get("section"),h=o.get("tab"),{data:r,error:p}=L({userId:x,id:s});if(p)return e.jsx("div",{className:"flex h-[60vh] items-center justify-center",children:e.jsxs("p",{className:"text-red-600 font-medium",children:["Error loading sections: ",JSON.stringify(p)]})});if(!r)return e.jsx("div",{className:"flex h-[60vh] items-center justify-center",children:e.jsx("div",{className:"animate-pulse text-gray-500",children:"Loading sections..."})});const m=(c=(l=r==null?void 0:r.data)==null?void 0:l.find(a=>a.section._id===b))==null?void 0:c.section,j=({section:a})=>e.jsxs(q,{to:`?section=${a._id}`,className:`
        group relative bg-white border border-gray-200 
        rounded-2xl shadow-sm hover:shadow-md hover:-translate-y-1
        transition-all duration-300 overflow-hidden
      `,children:[e.jsx("img",{src:a.logo,alt:a.name,className:"h-40 w-full object-cover opacity-95 group-hover:opacity-100 transition-all"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1 truncate",children:a.name}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Click to explore"})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-white/60 to-transparent opacity-0 group-hover:opacity-100 transition-all"})]}),g=({section:a})=>{const t=[{head:"Quiz",type:"quiz",image:a.quizImage||"https://res.cloudinary.com/drzyrq7d5/image/upload/v1757593501/quiz_ptz1ft.png"},{head:"Test Series",type:"test",image:a.testImage||"https://res.cloudinary.com/dkybjjott/image/upload/v1750263010/WhatsApp_Image_2025-06-11_at_21.12.06-removebg-preview_losyhk.png"}],N=n=>{i({section:a._id,tab:n})};return h==="quiz"?e.jsx(A,{sectionId:a._id,isGroup:!0}):h==="test"?e.jsx(D,{sectionId:a._id,isGroup:!0}):e.jsx("div",{className:"flex px-5  gap-8 py-6",children:t.map((n,f)=>e.jsxs("div",{onClick:()=>N(n.type),className:`
              cursor-pointer flex flex-col items-center
              bg-white rounded-2xl border border-gray-200
              shadow-sm hover:shadow-md hover:-translate-y-1
              transition-all duration-300 overflow-hidden
              w-80
            `,children:[e.jsx("img",{src:n.image,alt:n.head,className:"h-52 w-full object-contain  p-4"}),e.jsxs("div",{className:"flex flex-col items-center justify-center p-4 w-full",children:[e.jsx("hr",{className:"w-2/3 border-gray-200 mb-3"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 tracking-wide",children:n.head}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Click to view ",n.head.toLowerCase()]})]})]},f))})};return e.jsx("div",{className:"min-h-screen",children:m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("button",{onClick:()=>i({}),className:"text-sm text-blue-600 hover:text-blue-700 transition-all",children:"â† Back to sections"}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-800",children:m.name})]}),e.jsx(g,{section:m})]}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:(u=r==null?void 0:r.data)==null?void 0:u.map(a=>e.jsx(j,{section:a.section},a.section._id))})})})}export{F as default};
