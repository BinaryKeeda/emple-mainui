import{$ as l,as as P,at as S,au as C,av as d,aw as $,ax as k,ay as D,d as T,B as L,a as I,u,r as m,j as e,L as A,b as q,i as E,az as F,aA as B}from"./index-W_7DnO0K.js";import{C as U}from"./Coin-cNlGu4EA.js";import{L as R}from"./Lock-szoLno8l.js";import{D as _}from"./Dialog-BJP1hd39.js";import{D as z,a as M}from"./DialogTitle-C87MPUUy.js";import{D as G}from"./DialogContent-DkQkyZqc.js";import{B as g}from"./Button-BvAspG3L.js";import"./Paper-CEAiLYFk.js";import"./Typography-BoyanTWv.js";import"./index-CdsCzFEO.js";import"./extendSxProp-x_8OfL-C.js";const j=async()=>{var i;const{page:r,category:t}=l.getState().testUser,c=(i=l.getState().auth.user)==null?void 0:i._id;l.dispatch(P());try{const a=(await H({page:r,category:t,userId:c,limit:20,search:""})).data.data.getTests;l.dispatch(S({key:a.page,value:a.data})),l.dispatch(C(a.totalPages)),l.dispatch(d(a.page)),l.dispatch($()),a.totalPages<=r&&l.dispatch(k())}catch(s){l.dispatch(D(s.message)),console.log(s)}},H=async({page:r,limit:t,search:c,category:i,userId:s})=>{try{return await T.post(`${L}/graphql`,{query:`#graphql
                query GetTests (
                    $page: Int = 1,
                    $limit: Int = 10,
                    $search: String,
                    $category: String,
                    $userId: String!,
                ) {
                getTests(userId:$userId ,page:$page , limit:$limit, search: $search, category: $category) {
                    data {
                        slug
                        _id
                        category
                        name
                        duration
                        attempts
                        description
                    }
                        limit
                        page
                       totalItems,
                        totalPages
                }
            }
    `,variables:{page:r,limit:t,search:c,category:i,userId:s}},{withCredentials:!0})}catch(a){throw console.log(a),new Error("Failed to Load")}},O=()=>{var x,h;const{hasMore:r,page:t,loading:c,data:i,currentPage:s,totalPages:a}=I(o=>o.testUser),p=u(),[b,n]=m.useState(!1),[f,N]=m.useState(null),y=()=>{s==t-1||s==t?j():p(d(s+1))},w=()=>{s!=1&&p(d(s-1))};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative flex flex-col w-full overflow-scroll dark:text-white bg-white shadow-md rounded-lg bg-clip-border",children:c?e.jsx(A,{}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"w-full text-left table-auto min-w-max",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-support",children:[e.jsx("th",{className:"p-4 border-b border-slate-200 ",children:e.jsx("p",{className:"text-sm font-normal",children:"Title"})}),e.jsx("th",{className:"p-4 border-b border-slate-200 ",children:e.jsx("p",{className:"text-sm font-normal",children:"Description"})}),e.jsx("th",{className:"p-4 border-b border-slate-200 ",children:e.jsx("p",{className:"text-sm font-normal",children:"Duration"})}),e.jsx("th",{className:"p-4 border-b border-slate-200 ",children:e.jsx("p",{className:"text-sm font-normal",children:"Attempts"})}),e.jsx("th",{className:"p-4 border-b border-slate-200 ",children:e.jsx("p",{className:"text-sm font-normal",children:"Solve"})})]})}),e.jsx("tbody",{children:(x=i[s])==null?void 0:x.map((o,v)=>e.jsxs("tr",{className:"bg-primary",children:[e.jsx("td",{className:"p-4",children:e.jsx("p",{className:"font-semibold text-sm",children:o.name})}),e.jsx("td",{className:"p-4",children:e.jsx("p",{className:"text-sm",children:o.description})}),e.jsx("td",{className:"p-4",children:e.jsxs("p",{className:"text-sm",children:[o.duration," min."]})}),e.jsx("td",{className:"p-4",children:e.jsxs("p",{className:"text-sm",children:[o.attempts," / 1"]})}),e.jsx("td",{className:"text-black dark:text-white p-4",children:o.attempts===0?e.jsx("button",{className:"text-xs bg-sky-600 hover:bg-sky-500 text-white py-2 px-5 rounded-full",onClick:()=>{N(o.slug),n(!0)},children:"Attempt"}):e.jsx(R,{color:"inherit"})})]},v))})]}),e.jsxs("div",{className:"flex bg-support justify-between items-center px-4 py-3",children:[e.jsxs("div",{className:"text-sm",children:["Showing ",e.jsxs("b",{children:["1-",(h=i[s])==null?void 0:h.length]})," of ",a]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:w,disabled:s==1,className:"px-3 py-1 min-w-9 text-sm bg-primary border border-slate-200 rounded hover:border-slate-400 transition",children:"Prev"}),e.jsx("button",{disabled:!r&&s==t-1,onClick:y,className:"px-3 py-1 min-w-9 text-sm bg-primary border border-slate-200 rounded hover:border-slate-400 transition",children:"Next"})]})]})]})}),e.jsxs(_,{open:b,onClose:()=>n(!1),children:[e.jsx(z,{children:"Confirm Purchase"}),e.jsx(G,{children:e.jsxs("div",{className:"flex gap-2 items-center",children:["Attempting this test will cost 10",e.jsx(U,{}),"Do you want to continue?"]})}),e.jsxs(M,{children:[e.jsx(g,{onClick:()=>n(!1),children:"Cancel"}),e.jsx(q,{to:`/user/test/${f}`,children:e.jsx(g,{variant:"contained",color:"primary",children:"Proceed"})})]})]})]})};function ae(){const r=u(),{name:t}=E();return m.useEffect(()=>{r(F()),r(B(t)),j()},[t]),e.jsx(e.Fragment,{children:e.jsx(O,{category:t})})}export{ae as default};
