import{ai as Y,ah as ee,r as x,aj as re,b5 as I,a7 as ae,a5 as S,j as a,b2 as c,ak as te,al as oe,b3 as ie,e as ne,b as se,B as le,R as ce,bA as ge,u as de,a as O,o as pe,I as k,ae as me,af as he}from"./index-ChqbYpVw.js";import{u as ue}from"./useQuery-Cm-cyV-X.js";import{u as fe,G as ve}from"./api-BYNwkAQ7.js";import{D as xe,S as be,P as ye}from"./ShortText-BqI72WXU.js";import{D as w}from"./Divider-DGbf4oIr.js";import{u as A}from"./usePreviousProps-D6Knvdcx.js";function Oe(r){const{badgeContent:e,invisible:t=!1,max:i=99,showZero:s=!1}=r,g=A({badgeContent:e,max:i});let l=t;t===!1&&e===0&&!s&&(l=!0);const{badgeContent:o,max:n=i}=l?g:r,d=o&&Number(o)>n?`${n}+`:o;return{badgeContent:o,invisible:l,max:n,displayValue:d}}function je(r){return ee("MuiBadge",r)}const p=Y("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),j=10,C=4,Ce=r=>{const{color:e,anchorOrigin:t,invisible:i,overlap:s,variant:g,classes:l={}}=r,o={root:["root"],badge:["badge",g,i&&"invisible",`anchorOrigin${c(t.vertical)}${c(t.horizontal)}`,`anchorOrigin${c(t.vertical)}${c(t.horizontal)}${c(s)}`,`overlap${c(s)}`,e!=="default"&&`color${c(e)}`]};return te(o,je,l)},Ne=S("span",{name:"MuiBadge",slot:"Root",overridesResolver:(r,e)=>e.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),Re=S("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(r,e)=>{const{ownerState:t}=r;return[e.badge,e[t.variant],e[`anchorOrigin${c(t.anchorOrigin.vertical)}${c(t.anchorOrigin.horizontal)}${c(t.overlap)}`],t.color!=="default"&&e[`color${c(t.color)}`],t.invisible&&e.invisible]}})(oe(({theme:r})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:r.typography.fontFamily,fontWeight:r.typography.fontWeightMedium,fontSize:r.typography.pxToRem(12),minWidth:j*2,lineHeight:1,padding:"0 6px",height:j*2,borderRadius:j,zIndex:1,transition:r.transitions.create("transform",{easing:r.transitions.easing.easeInOut,duration:r.transitions.duration.enteringScreen}),variants:[...Object.entries(r.palette).filter(ie(["contrastText"])).map(([e])=>({props:{color:e},style:{backgroundColor:(r.vars||r).palette[e].main,color:(r.vars||r).palette[e].contrastText}})),{props:{variant:"dot"},style:{borderRadius:C,height:C*2,minWidth:C*2,padding:0}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${p.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${p.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${p.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${p.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${p.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${p.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${p.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${p.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:r.transitions.create("transform",{easing:r.transitions.easing.easeInOut,duration:r.transitions.duration.leavingScreen})}}]})));function L(r){return{vertical:(r==null?void 0:r.vertical)??"top",horizontal:(r==null?void 0:r.horizontal)??"right"}}const Pe=x.forwardRef(function(e,t){const i=re({props:e,name:"MuiBadge"}),{anchorOrigin:s,className:g,classes:l,component:o,components:n={},componentsProps:d={},children:u,overlap:f="rectangular",color:v="default",invisible:U=!1,max:_=99,badgeContent:N,slots:m,slotProps:h,showZero:R=!1,variant:b="standard",...F}=i,{badgeContent:P,invisible:E,max:M,displayValue:V}=Oe({max:_,invisible:U,badgeContent:N,showZero:R}),W=A({anchorOrigin:L(s),color:v,overlap:f,variant:b,badgeContent:N}),B=E||P==null&&b!=="dot",{color:G=v,overlap:H=f,anchorOrigin:q,variant:T=b}=B?W:i,Q=L(q),$=T!=="dot"?V:void 0,y={...i,badgeContent:P,invisible:B,max:M,displayValue:$,showZero:R,anchorOrigin:Q,color:G,overlap:H,variant:T},z=Ce(y),D={slots:{root:(m==null?void 0:m.root)??n.Root,badge:(m==null?void 0:m.badge)??n.Badge},slotProps:{root:(h==null?void 0:h.root)??d.root,badge:(h==null?void 0:h.badge)??d.badge}},[K,Z]=I("root",{elementType:Ne,externalForwardedProps:{...D,...F},ownerState:y,className:ae(z.root,g),ref:t,additionalProps:{as:o}}),[J,X]=I("badge",{elementType:Re,externalForwardedProps:D,ownerState:y,className:z.badge});return a.jsxs(K,{...Z,children:[u,a.jsx(J,{...X,children:$})]})}),Be=ne(a.jsx("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"}),"Notifications"),Te="#1d1e20",$e=async r=>(await fe.get(ve.GET_USER_INVITE+r)).data,ze=({userId:r})=>ue({queryKey:["inviteData",r],queryFn:()=>$e(r),onSuccess:(e,t,i)=>{i.queryClient.invalidateQueries(["inviteData",r]),i.queryClient.invalidateQueries(["groupData",r])}});function De({notificationOpen:r,setNotificationOpen:e,userId:t,refreshInvites:i}){var l;const{data:s}=ze({userId:t}),g=async(o,n,d)=>{try{await se.post(le+"/api/data/invites/respond",{inviteId:o,accept:n==="accept",section:d},{withCredentials:!0})}catch(u){console.error("Error responding to invite:",u)}};return a.jsx(xe,{anchor:"right",open:r,onClose:()=>e(!1),children:a.jsxs("div",{className:"w-80 p-4",children:[a.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Notifications"}),a.jsx(w,{className:"mb-2"}),a.jsx("ul",{className:"space-y-4 mt-3",children:(l=s==null?void 0:s.data)!=null&&l.length?s.data.map(o=>{var n;return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl shadow-sm border",children:[a.jsxs("div",{className:"text-sm",children:[a.jsxs("p",{className:"font-medium",children:[(n=o.invitedBy)==null?void 0:n.name," invited you to join a group"]}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Role: ",o.role," ·"," ",new Date(o.createdAt).toLocaleString()]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>g(o._id,"accept",o.sectionId),className:"px-2 py-1 text-xs rounded-lg bg-green-500 text-white hover:bg-green-600",children:"✅"}),a.jsx("button",{onClick:()=>g(o._id,"reject",o.sectionId),className:"px-2 py-1 text-xs rounded-lg bg-red-500 text-white hover:bg-red-600",children:"❌"})]})]},o._id)}):a.jsx("li",{className:"text-sm text-gray-500",children:"No pending invites"})})]})})}const Ue=ce.memo(({user:r,menuOpen:e,setMenuOpen:t})=>{const{toggleTheme:i,theme:s}=x.useContext(ge),g=de(),[l,o]=x.useState(!1),[n,d]=x.useState(0),u=()=>{try{g(me(he.get("token")))}catch(v){console.log(v,"logout")}},f=()=>{o(!0),d(0)};return a.jsxs(a.Fragment,{children:[a.jsx("header",{className:"relative h-[59px]",children:a.jsxs("nav",{className:`fixed shadow-sm bg-white dark:bg-support dark:text-gray-50 bg-blend-difference text-gray-600 h-[59px] items-center pr-5 pl-2 flex justify-between z-40 w-full top-0 dark:bg-[${Te}]`,children:[a.jsx("div",{className:"lg:hidden",children:a.jsx(be,{onClick:()=>t(!e)})}),a.jsx("div",{className:"flex md:ml-[100px] gap-1 items-center",children:a.jsx(O,{to:"/",children:a.jsx("img",{src:pe,className:"h-10",alt:"Logo"})})}),a.jsx("div",{className:"flex items-center gap-3",children:r?a.jsxs(a.Fragment,{children:[a.jsx(k,{"aria-label":"notifications",onClick:f,children:a.jsx(Pe,{badgeContent:n,color:"error",overlap:"circular",children:a.jsx(Be,{})})}),a.jsx(k,{onClick:u,children:a.jsx(ye,{})})]}):a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(O,{to:"/login",className:"text-sm font-medium hover:underline",children:"Login"}),a.jsx(w,{orientation:"vertical",flexItem:!0,sx:{bgcolor:"grey.500"}}),a.jsx(O,{to:"/register",className:"text-sm font-medium hover:underline",children:"Signup"})]})})]})}),a.jsx(De,{userId:r==null?void 0:r._id,notificationOpen:l,setNotificationOpen:o})]})});export{Ue as H};
