import{w as Y,v as ee,r as v,x as re,aF as k,z as te,y as A,j as t,aC as l,A as ae,an as oe,aD as ie,e as ne,d as se,B as le,R as ce,b8 as de,u as ge,c as pe,b as O,o as he,I as S,ak as me,al as fe}from"./index-B7On-SPP.js";import{u as xe,G as ue}from"./api-BdoYcqs8.js";import{D as ve}from"./Drawer-B0OM26im.js";import{D as _}from"./Divider-BHBak28k.js";import{u as be}from"./useQuery-DGmGbAKA.js";import{S as ye,P as je}from"./ShortText-DQ6DucoY.js";import{u as F}from"./usePreviousProps-3xmpc4XY.js";function Oe(r){const{badgeContent:e,invisible:a=!1,max:i=99,showZero:d=!1}=r,c=F({badgeContent:e,max:i});let s=a;a===!1&&e===0&&!d&&(s=!0);const{badgeContent:o,max:n=i}=s?c:r,g=o&&Number(o)>n?`${n}+`:o;return{badgeContent:o,invisible:s,max:n,displayValue:g}}function Ne(r){return ee("MuiBadge",r)}const h=Y("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),N=10,C=4,Ce=r=>{const{color:e,anchorOrigin:a,invisible:i,overlap:d,variant:c,classes:s={}}=r,o={root:["root"],badge:["badge",c,i&&"invisible",`anchorOrigin${l(a.vertical)}${l(a.horizontal)}`,`anchorOrigin${l(a.vertical)}${l(a.horizontal)}${l(d)}`,`overlap${l(d)}`,e!=="default"&&`color${l(e)}`]};return ae(o,Ne,s)},Re=A("span",{name:"MuiBadge",slot:"Root",overridesResolver:(r,e)=>e.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),Be=A("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(r,e)=>{const{ownerState:a}=r;return[e.badge,e[a.variant],e[`anchorOrigin${l(a.anchorOrigin.vertical)}${l(a.anchorOrigin.horizontal)}${l(a.overlap)}`],a.color!=="default"&&e[`color${l(a.color)}`],a.invisible&&e.invisible]}})(oe(({theme:r})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:r.typography.fontFamily,fontWeight:r.typography.fontWeightMedium,fontSize:r.typography.pxToRem(12),minWidth:N*2,lineHeight:1,padding:"0 6px",height:N*2,borderRadius:N,zIndex:1,transition:r.transitions.create("transform",{easing:r.transitions.easing.easeInOut,duration:r.transitions.duration.enteringScreen}),variants:[...Object.entries(r.palette).filter(ie(["contrastText"])).map(([e])=>({props:{color:e},style:{backgroundColor:(r.vars||r).palette[e].main,color:(r.vars||r).palette[e].contrastText}})),{props:{variant:"dot"},style:{borderRadius:C,height:C*2,minWidth:C*2,padding:0}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${h.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${h.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${h.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${h.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${h.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${h.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${h.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${h.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:r.transitions.create("transform",{easing:r.transitions.easing.easeInOut,duration:r.transitions.duration.leavingScreen})}}]})));function L(r){return{vertical:(r==null?void 0:r.vertical)??"top",horizontal:(r==null?void 0:r.horizontal)??"right"}}const Pe=v.forwardRef(function(e,a){const i=re({props:e,name:"MuiBadge"}),{anchorOrigin:d,className:c,classes:s,component:o,components:n={},componentsProps:g={},children:p,overlap:x="rectangular",color:u="default",invisible:R=!1,max:b=99,badgeContent:B,slots:m,slotProps:f,showZero:P=!1,variant:y="standard",...U}=i,{badgeContent:w,invisible:E,max:M,displayValue:V}=Oe({max:b,invisible:R,badgeContent:B,showZero:P}),G=F({anchorOrigin:L(d),color:u,overlap:x,variant:y,badgeContent:B}),z=E||w==null&&y!=="dot",{color:W=u,overlap:q=x,anchorOrigin:H,variant:T=y}=z?G:i,K=L(H),$=T!=="dot"?V:void 0,j={...i,badgeContent:w,invisible:z,max:M,displayValue:$,showZero:P,anchorOrigin:K,color:W,overlap:q,variant:T},D=Ce(j),I={slots:{root:(m==null?void 0:m.root)??n.Root,badge:(m==null?void 0:m.badge)??n.Badge},slotProps:{root:(f==null?void 0:f.root)??g.root,badge:(f==null?void 0:f.badge)??g.badge}},[Q,Z]=k("root",{elementType:Re,externalForwardedProps:{...I,...U},ownerState:j,className:te(D.root,c),ref:a,additionalProps:{as:o}}),[J,X]=k("badge",{elementType:Be,externalForwardedProps:I,ownerState:j,className:D.badge});return t.jsxs(Q,{...Z,children:[p,t.jsx(J,{...X,children:$})]})}),we=ne(t.jsx("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"}),"Notifications"),ze="#1d1e20",Te=async r=>(await xe.get(ue.GET_USER_INVITE+r)).data,$e=({userId:r})=>be({queryKey:["inviteData",r],queryFn:()=>Te(r),onSuccess:(e,a,i)=>{i.queryClient.invalidateQueries(["inviteData",r]),i.queryClient.invalidateQueries(["groupData",r])}});function De({notificationOpen:r,setNotificationOpen:e,data:a,userId:i,refreshInvites:d}){var s;const c=async(o,n,g)=>{try{await se.post(le+"/api/data/invites/respond",{inviteId:o,accept:n==="accept",section:g},{withCredentials:!0}),window.location.reload()}catch(p){console.error("Error responding to invite:",p)}};return t.jsx(ve,{anchor:"right",open:r,onClose:()=>e(!1),children:t.jsxs("div",{className:"w-80 p-4",children:[t.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Notifications"}),t.jsx(_,{className:"mb-2"}),t.jsx("ul",{className:"space-y-4 mt-3",children:(s=a==null?void 0:a.data)!=null&&s.length?a.data.map(o=>{var n;return t.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl shadow-sm border",children:[t.jsxs("div",{className:"text-sm",children:[t.jsxs("p",{className:"font-medium",children:[(n=o.invitedBy)==null?void 0:n.name," invited you to join a group"]}),t.jsxs("p",{className:"text-xs text-gray-500",children:["Role: ",o.role," ·"," ",new Date(o.createdAt).toLocaleString()]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>c(o._id,"accept",o.sectionId),className:"px-2 py-1 text-xs rounded-lg bg-green-500 text-white hover:bg-green-600",children:"✅"}),t.jsx("button",{onClick:()=>c(o._id,"reject",o.sectionId),className:"px-2 py-1 text-xs rounded-lg bg-red-500 text-white hover:bg-red-600",children:"❌"})]})]},o._id)}):t.jsx("li",{className:"text-sm text-gray-500",children:"No pending invites"})})]})})}const Ue=ce.memo(({user:r,menuOpen:e,setMenuOpen:a})=>{const{toggleTheme:i,theme:d}=v.useContext(de),c=ge(),[s,o]=v.useState(!1),[n,g]=v.useState(0),{data:p}=$e(r?{userId:r._id}:{}),x=()=>{try{c(me(fe.get("token")))}catch(b){console.log(b,"logout")}},u=()=>{o(!0),g(0)},{enqueueSnackbar:R}=pe();return t.jsxs(t.Fragment,{children:[t.jsx("header",{className:"relative h-[59px]",children:t.jsxs("nav",{className:`fixed shadow-sm bg-white dark:bg-support dark:text-gray-50 bg-blend-difference text-gray-600 h-[59px] items-center pr-5 pl-2 flex justify-between z-40 w-full top-0 dark:bg-[${ze}]`,children:[t.jsx("div",{className:"lg:hidden",children:t.jsx(ye,{onClick:()=>a(!e)})}),t.jsx("div",{className:"flex md:ml-[100px] gap-1 items-center",children:t.jsx(O,{to:"/",children:t.jsx("img",{src:he,className:"h-10",alt:"Logo"})})}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex gap-1 rounded-lg items-center",children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 128 128",width:"30",height:"30",children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:"lg",x1:"0",x2:"1",children:[t.jsx("stop",{offset:"0","stop-color":"#fff4d6"}),t.jsx("stop",{offset:"1","stop-color":"#ffd14d"})]})}),t.jsx("circle",{cx:"64",cy:"64",r:"60",fill:"#b88700"}),t.jsx("circle",{cx:"64",cy:"64",r:"52",fill:"url(#lg)"}),t.jsx("g",{transform:"translate(64,57) scale(2.4)",children:t.jsx("text",{x:"0",y:"10","text-anchor":"middle","font-size":"20","font-family":"Inter, Arial",fill:"#7a3f00","font-weight":"900",children:"BK"})})]}),t.jsx("div",{className:"text-sm",children:t.jsx("span",{children:r==null?void 0:r.coins})})]}),r?t.jsxs(t.Fragment,{children:[t.jsx(S,{"aria-label":"notifications",onClick:u,children:t.jsxs(Pe,{badgeContent:n,color:"error",sx:{position:"relative"},overlap:"circular",children:[t.jsx(we,{}),t.jsx("span",{className:"text-xs bg-red-500 text-white -right-2  h-4 rounded-full absolute w-4",children:JSON.stringify(p==null?void 0:p.data.length)||0})]})}),t.jsx(S,{onClick:x,children:t.jsx(je,{})})]}):t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx(O,{to:"/login",className:"text-sm font-medium hover:underline",children:"Login"}),t.jsx(_,{orientation:"vertical",flexItem:!0,sx:{bgcolor:"grey.500"}}),t.jsx(O,{to:"/register",className:"text-sm font-medium hover:underline",children:"Signup"})]})]})]})}),t.jsx(De,{data:p,userId:r==null?void 0:r._id,notificationOpen:s,setNotificationOpen:o})]})});export{Ue as H};
