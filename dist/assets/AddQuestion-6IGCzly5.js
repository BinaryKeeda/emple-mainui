import{e as C,j as e,c as F,r as f,I,C as N,D,d as A,B as L}from"./index-SIXkfFwE.js";import{T as o}from"./TextField-B7rrEHOi.js";import{M as x}from"./MenuItem-D4JdyKZo.js";import{B as b}from"./Button-CsFkzLaw.js";const E=C(e.jsx("path",{d:"m7 10 5 5 5-5z"}),"ArrowDropDown"),W=C(e.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96"}),"Cloud"),O=C(e.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm4 18H6V4h7v5h5zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11z"}),"UploadFile"),H=c=>{let u=0;for(let m=0;m<c.length;m++)u+=parseInt(c[m].marks);return u};function V({quizId:c,maxMarks:u,currentMarks:m,setCurrentMarks:T,onRefresh:w}){const{enqueueSnackbar:p}=F(),v={quizId:c,question:"",image:"",marks:"",category:"",answer:"",negative:"",options:[{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1},{text:"",isCorrect:!1}]},[a,n]=f.useState(v),[g,h]=f.useState(""),[j,y]=f.useState(!1),i=t=>{const{name:s,value:r,type:M,files:l}=t.target;if(M==="file"&&l.length>0){const d=l[0];n(Q=>({...Q,[s]:d})),h(URL.createObjectURL(d))}else n(d=>({...d,[s]:r}))},q=(t,s)=>{const r=[...a.options];r[t].text=s,n({...a,options:r})},k=(t,s)=>{const r=[...a.options];s==="MCQ"?r.forEach((M,l)=>r[l].isCorrect=l===t):r[t].isCorrect=!r[t].isCorrect,n({...a,options:r})},z=()=>{n(t=>({...t,image:""})),h("")},S=async t=>{if(t.preventDefault(),!a.question||!a.category||parseFloat(a.marks)>u){p("Please fill all required fields correctly!",{variant:"warning"});return}y(!0);const s=new FormData;a.image&&s.append("image",a.image),s.append("data",JSON.stringify({quizId:a.quizId,question:a.question,marks:parseFloat(a.marks)||0,category:a.category,answer:a.answer,options:a.options,negative:parseFloat(a.negative)||0}));try{await A.post(`${L}/api/admin/quiz/add/question`,s,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}),p("Question added successfully!",{variant:"success"}),w(),n(v),h("")}catch(r){console.error(r),p("Failed to add question. Try again!",{variant:"error"})}y(!1)};return e.jsxs("form",{onSubmit:S,className:"space-y-4 bg-white p-5",children:[e.jsx(o,{minRows:2,size:"small",fullWidth:!0,name:"question",label:"Question",multiline:!0,value:a.question,onChange:i,required:!0}),e.jsx(o,{size:"small",fullWidth:!0,name:"marks",type:"number",label:"Marks",value:a.marks,onChange:i,inputProps:{min:0,step:"any"},required:!0}),e.jsx(o,{size:"small",fullWidth:!0,name:"negative",type:"number",label:"Negative Marks",value:a.negative,onChange:i,inputProps:{min:0,step:"any"}}),e.jsxs(o,{size:"small",select:!0,fullWidth:!0,name:"category",label:"Category",value:a.category,onChange:i,required:!0,children:[e.jsx(x,{value:"MCQ",children:"MCQ"}),e.jsx(x,{value:"MSQ",children:"MSQ"}),e.jsx(x,{value:"Text",children:"Text"})]}),a.category==="Text"&&e.jsx(o,{size:"small",fullWidth:!0,name:"answer",label:"Answer",value:a.answer,onChange:i,required:!0}),(a.category==="MCQ"||a.category==="MSQ")&&e.jsx("div",{className:"grid grid-cols-1 gap-2",children:a.options.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{size:"small",className:"flex-1",label:`Option ${s+1}`,value:t.text,onChange:r=>q(s,r.target.value),required:!0}),a.category==="MCQ"?e.jsx("input",{type:"radio",name:"correctOption",checked:t.isCorrect,onChange:()=>k(s,"MCQ")}):e.jsx("input",{type:"checkbox",checked:t.isCorrect,onChange:()=>k(s,"MSQ")}),"Correct"]},s))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(b,{component:"label",variant:"outlined",startIcon:e.jsx(O,{}),children:["Upload Image",e.jsx("input",{type:"file",name:"image",hidden:!0,onChange:i})]}),g&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("img",{src:g,alt:"Preview",className:"h-20 object-contain cursor-pointer",onClick:()=>{var t;return(t=document.getElementById("image-full"))==null?void 0:t.requestFullscreen()}}),e.jsx(I,{size:"small",onClick:z,children:e.jsx(N,{})})]}),e.jsx("img",{src:g,id:"image-full",className:"hidden",alt:"fullscreen"})]}),e.jsx(b,{type:"submit",variant:"contained",disabled:j,children:j?e.jsx(D,{size:20}):"Add Question"})]})}export{V as A,W as C,O as U,E as a,H as c};
