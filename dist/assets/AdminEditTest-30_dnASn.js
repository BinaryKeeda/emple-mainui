const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddTestProblemModal-DHpIY1A3.js","assets/index-BriX2T-R.js","assets/index-QIgYHzyf.css","assets/Box-9eZe0IYj.js","assets/extendSxProp-zFBgj-vU.js","assets/Typography-BSbAbgZL.js","assets/index-DMHtXYTv.js","assets/Menu-Djv01B1W.js","assets/index-B3bFVV5s.js","assets/useSlotProps-BWEbU_kp.js","assets/Paper-BszZzkG0.js","assets/Grow-DZw0cfma.js","assets/mergeSlotProps-QbqcnI_T.js","assets/ListItemText-CrjgwJ0v.js","assets/Select-Bb2VYELU.js","assets/MenuItem-BUfvdctT.js","assets/dividerClasses-FC_JthQF.js","assets/Button-SREuLjmf.js","assets/AddTestSectionQuestionsModal-CBOAsPUD.js","assets/xlsx-CygJKsBP.js","assets/Upload-DJAERNKi.js","assets/TextField-CGLbAYmc.js","assets/Radio-C3rrnRVT.js","assets/SwitchBase-DobhOEPd.js","assets/Checkbox-Cx6q7SbG.js"])))=>i.map(i=>d[i]);
import{i as L,r as l,j as e,D as V,d as x,B as p,ak as Q}from"./index-BriX2T-R.js";import{A as B}from"./Add-jmSy_Kbe.js";import{T as g}from"./Typography-BSbAbgZL.js";import{T as n}from"./TextField-CGLbAYmc.js";import{M as r}from"./MenuItem-BUfvdctT.js";import{B as u}from"./Button-SREuLjmf.js";import{P as R}from"./Paper-BszZzkG0.js";import{A as G,a as U,b as H}from"./AccordionSummary-Bq81ujb7.js";import"./index-DMHtXYTv.js";import"./extendSxProp-zFBgj-vU.js";import"./Select-Bb2VYELU.js";import"./Menu-Djv01B1W.js";import"./index-B3bFVV5s.js";import"./useSlotProps-BWEbU_kp.js";import"./Grow-DZw0cfma.js";import"./mergeSlotProps-QbqcnI_T.js";import"./dividerClasses-FC_JthQF.js";const J=l.lazy(()=>Q(()=>import("./AddTestProblemModal-DHpIY1A3.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]))),K=l.lazy(()=>Q(()=>import("./AddTestSectionQuestionsModal-CBOAsPUD.js"),__vite__mapDeps([18,1,2,19,3,4,5,6,17,20,21,14,7,8,9,10,11,12,15,16,22,23,24])));function he(){const{id:o}=L(),[t,i]=l.useState(null),[w,M]=l.useState(!0),[j,E]=l.useState(null),[d,m]=l.useState({name:"",sectionType:"Quiz"}),[y,b]=l.useState(!1),[f,v]=l.useState(!1),[F,C]=l.useState(null),[$,N]=l.useState(null),k=s=>C(s),S=()=>C(null),D=s=>N(s),T=()=>N(null),h=async()=>{try{const s=await x.get(`${p}/api/admin/tests/${o}`,{withCredentials:!0});i(s.data.data)}catch{E("Failed to fetch test")}finally{M(!1)}};l.useEffect(()=>{h()},[o]);const I=async()=>{try{b(!0);const s=await x.post(`${p}/api/admin/tests/${o}/sections`,d,{withCredentials:!0});i(s.data.data),m({name:"",sectionType:"Quiz"})}catch(s){console.error("Failed to add section",s),alert("Failed to add section")}finally{b(!1)}},O=async()=>{try{v(!0);const s=await x.put(`${p}/api/admin/tests/update/${o}`,t,{withCredentials:!0});i(s.data.data)}catch(s){console.error("Failed to update test",s),alert("Failed to save changes")}finally{v(!1)}};return w?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(V,{})}):j?e.jsx(g,{color:"error",children:j}):e.jsxs("div",{className:"p-6 md:p-10 bg-gray-50 min-h-screen",children:[e.jsxs("h4",{className:"font-bold mb-6 text-gray-800 text-xl",children:["Edit Test - ",t.name]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsx(n,{size:"small",label:"Test Name",value:t.name,onChange:s=>i({...t,name:s.target.value}),fullWidth:!0}),e.jsx(n,{size:"small",label:"Duration (minutes)",type:"number",value:t.duration||"",onChange:s=>i({...t,duration:parseInt(s.target.value)}),fullWidth:!0}),e.jsx(n,{label:"Description",size:"small",value:t.description||"",onChange:s=>i({...t,description:s.target.value}),fullWidth:!0,multiline:!0,rows:3}),e.jsxs(n,{select:!0,size:"small",label:"Category",value:t.category,onChange:s=>i({...t,category:s.target.value}),fullWidth:!0,children:[e.jsx(r,{value:"Placements",children:"Placements"}),e.jsx(r,{value:"Gate",children:"Gate"})]}),e.jsxs(n,{select:!0,size:"small",label:"Visibility",value:t.visibility,onChange:s=>i({...t,visibility:s.target.value}),fullWidth:!0,children:[e.jsx(r,{value:"private",children:"Private"}),e.jsx(r,{value:"public",children:"Public"}),e.jsx(r,{value:"group",children:"Group"})]}),e.jsxs(n,{select:!0,size:"small",label:"Availability",value:t.isAvailable?"true":"false",onChange:s=>i({...t,isAvailable:s.target.value==="true"}),fullWidth:!0,children:[e.jsx(r,{value:"true",children:"Available"}),e.jsx(r,{value:"false",children:"Not Available"})]})]}),e.jsx(u,{variant:"contained",color:"primary",onClick:O,disabled:f,className:"mb-8",children:f?"Saving...":"Save Changes"}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h1",{className:"font-medium mb-2 pl-1 text-gray-700",children:"Add New Section"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(n,{size:"small",label:"Section Name",value:d.name,onChange:s=>m({...d,name:s.target.value})}),e.jsxs(n,{size:"small",select:!0,label:"Type",value:d.sectionType,onChange:s=>m({...d,sectionType:s.target.value}),children:[e.jsx(r,{value:"Quiz",children:"Quiz"}),e.jsx(r,{value:"Coding",children:"Coding"})]}),e.jsx(u,{variant:"contained",startIcon:e.jsx(B,{}),onClick:I,disabled:y||!d.name,children:y?"Adding...":"Add Section"})]})]}),e.jsx("h2",{className:"font-semibold pl-1 mt-6 mb-4 text-gray-700 text-lg",children:"Sections"}),t.sections.length===0&&e.jsx("p",{className:"text-gray-500 italic mb-4",children:"No sections added yet."}),t.sections.map((s,W)=>{var A,z,P,_;return e.jsxs(R,{className:"p-4 mb-4 shadow-sm border rounded-lg bg-white",children:[e.jsx(g,{className:"font-semibold text-lg",children:s.name}),e.jsxs(g,{variant:"body2",color:"textSecondary",children:["Type:"," ",s.sectionType==="Quiz"?`Quiz Questions ${((A=s.questionSet)==null?void 0:A.length)||0}`:`Coding Problems ${((z=s.problemset)==null?void 0:z.length)||0}`]}),e.jsxs("div",{className:"flex flex-col gap-4 mt-4",children:[s.sectionType==="Quiz"&&e.jsx(u,{size:"small",variant:"outlined",onClick:()=>D(s._id),children:"Add Questions"}),s.sectionType==="Coding"&&e.jsx(u,{size:"small",variant:"outlined",onClick:()=>k(s._id),children:"Add Problems"}),e.jsxs(G,{children:[e.jsx(U,{children:s.sectionType==="Quiz"?"View Questions":"View Problems"}),e.jsx(H,{children:s.sectionType==="Quiz"?(P=s.questionSet)!=null&&P.length?e.jsx("ul",{className:"list-disc ml-6 space-y-2 text-sm text-gray-800",children:s.questionSet.map((a,c)=>e.jsxs("li",{children:[e.jsx("strong",{children:a.question||`Question ${c+1}`}),e.jsx("br",{}),e.jsx("span",{className:"text-gray-600",children:"Type:"})," ",a.category,e.jsx("br",{}),a.difficulty&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"Difficulty:"})," ",a.difficulty,e.jsx("br",{})]}),a.marks&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"Marks:"})," ",a.marks]})]},a._id||c))}):e.jsx("p",{className:"text-gray-500 italic",children:"No questions added yet."}):(_=s.problemset)!=null&&_.length?e.jsx("ul",{className:"list-disc ml-6 space-y-2 text-sm text-gray-800",children:s.problemset.map((a,c)=>e.jsxs("li",{children:[e.jsx("strong",{children:a.title||`Problem ${c+1}`}),e.jsx("br",{}),a.difficulty&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"Difficulty:"})," ",a.difficulty,e.jsx("br",{})]}),Array.isArray(a.tags)&&a.tags.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"Tags:"})," ",a.tags.join(", ")]})]},a._id||c))}):e.jsx("p",{className:"text-gray-500 italic",children:"No problems added yet."})})]})]}),e.jsxs(l.Suspense,{fallback:e.jsx("div",{children:"Loading modal..."}),children:[$===s._id&&s.sectionType==="Quiz"&&e.jsx(K,{open:!0,onClose:T,testId:o,sectionId:s._id,onSuccess:()=>{h(),T()}}),F===s._id&&s.sectionType==="Coding"&&e.jsx(J,{open:!0,onClose:S,testId:o,sectionId:s._id,onSuccess:()=>{h(),S()}})]})]},W)})]})}export{he as default};
