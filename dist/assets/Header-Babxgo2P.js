import{ag as Y,af as rr,r as v,ah as er,b3 as k,a5 as ar,a3 as w,j as a,b0 as c,ai as tr,aj as or,b1 as ir,e as nr,d as sr,B as lr,R as cr,by as gr,u as dr,c as pr,b as j,o as mr,I as S,ac as hr,ad as ur}from"./index-CwFirUwE.js";import{u as fr}from"./useQuery-D5ti0kfA.js";import{u as vr,G as xr}from"./api-l56yVG8G.js";import{D as br}from"./Drawer-DwQNIERj.js";import{D as U}from"./Divider-h6xahCoz.js";import{S as yr,P as Or}from"./ShortText-kH79c3Bj.js";import{u as _}from"./usePreviousProps-kwdUn829.js";function jr(e){const{badgeContent:r,invisible:t=!1,max:i=99,showZero:s=!1}=e,g=_({badgeContent:r,max:i});let l=t;t===!1&&r===0&&!s&&(l=!0);const{badgeContent:o,max:n=i}=l?g:e,d=o&&Number(o)>n?`${n}+`:o;return{badgeContent:o,invisible:l,max:n,displayValue:d}}function Cr(e){return rr("MuiBadge",e)}const p=Y("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),C=10,N=4,Nr=e=>{const{color:r,anchorOrigin:t,invisible:i,overlap:s,variant:g,classes:l={}}=e,o={root:["root"],badge:["badge",g,i&&"invisible",`anchorOrigin${c(t.vertical)}${c(t.horizontal)}`,`anchorOrigin${c(t.vertical)}${c(t.horizontal)}${c(s)}`,`overlap${c(s)}`,r!=="default"&&`color${c(r)}`]};return tr(o,Cr,l)},Rr=w("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,r)=>r.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),Pr=w("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.badge,r[t.variant],r[`anchorOrigin${c(t.anchorOrigin.vertical)}${c(t.anchorOrigin.horizontal)}${c(t.overlap)}`],t.color!=="default"&&r[`color${c(t.color)}`],t.invisible&&r.invisible]}})(or(({theme:e})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:C*2,lineHeight:1,padding:"0 6px",height:C*2,borderRadius:C,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen}),variants:[...Object.entries(e.palette).filter(ir(["contrastText"])).map(([r])=>({props:{color:r},style:{backgroundColor:(e.vars||e).palette[r].main,color:(e.vars||e).palette[r].contrastText}})),{props:{variant:"dot"},style:{borderRadius:N,height:N*2,minWidth:N*2,padding:0}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${p.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${p.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${p.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${p.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${p.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${p.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${p.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${p.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})}}]})));function L(e){return{vertical:(e==null?void 0:e.vertical)??"top",horizontal:(e==null?void 0:e.horizontal)??"right"}}const Br=v.forwardRef(function(r,t){const i=er({props:r,name:"MuiBadge"}),{anchorOrigin:s,className:g,classes:l,component:o,components:n={},componentsProps:d={},children:u,overlap:f="rectangular",color:x="default",invisible:b=!1,max:A=99,badgeContent:R,slots:m,slotProps:h,showZero:P=!1,variant:y="standard",...F}=i,{badgeContent:B,invisible:E,max:M,displayValue:V}=jr({max:A,invisible:b,badgeContent:R,showZero:P}),W=_({anchorOrigin:L(s),color:x,overlap:f,variant:y,badgeContent:R}),T=E||B==null&&y!=="dot",{color:q=x,overlap:G=f,anchorOrigin:H,variant:$=y}=T?W:i,Q=L(H),z=$!=="dot"?V:void 0,O={...i,badgeContent:B,invisible:T,max:M,displayValue:z,showZero:P,anchorOrigin:Q,color:q,overlap:G,variant:$},D=Nr(O),I={slots:{root:(m==null?void 0:m.root)??n.Root,badge:(m==null?void 0:m.badge)??n.Badge},slotProps:{root:(h==null?void 0:h.root)??d.root,badge:(h==null?void 0:h.badge)??d.badge}},[K,Z]=k("root",{elementType:Rr,externalForwardedProps:{...I,...F},ownerState:O,className:ar(D.root,g),ref:t,additionalProps:{as:o}}),[J,X]=k("badge",{elementType:Pr,externalForwardedProps:I,ownerState:O,className:D.badge});return a.jsxs(K,{...Z,children:[u,a.jsx(J,{...X,children:z})]})}),Tr=nr(a.jsx("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"}),"Notifications"),$r="#1d1e20",zr=async e=>(await vr.get(xr.GET_USER_INVITE+e)).data,Dr=({userId:e})=>fr({queryKey:["inviteData",e],queryFn:()=>zr(e),onSuccess:(r,t,i)=>{i.queryClient.invalidateQueries(["inviteData",e]),i.queryClient.invalidateQueries(["groupData",e])}});function Ir({notificationOpen:e,setNotificationOpen:r,userId:t,refreshInvites:i}){var l;const{data:s}=Dr({userId:t}),g=async(o,n,d)=>{try{await sr.post(lr+"/api/data/invites/respond",{inviteId:o,accept:n==="accept",section:d},{withCredentials:!0})}catch(u){console.error("Error responding to invite:",u)}};return a.jsx(br,{anchor:"right",open:e,onClose:()=>r(!1),children:a.jsxs("div",{className:"w-80 p-4",children:[a.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Notifications"}),a.jsx(U,{className:"mb-2"}),a.jsx("ul",{className:"space-y-4 mt-3",children:(l=s==null?void 0:s.data)!=null&&l.length?s.data.map(o=>{var n;return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl shadow-sm border",children:[a.jsxs("div",{className:"text-sm",children:[a.jsxs("p",{className:"font-medium",children:[(n=o.invitedBy)==null?void 0:n.name," invited you to join a group"]}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Role: ",o.role," ·"," ",new Date(o.createdAt).toLocaleString()]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>g(o._id,"accept",o.sectionId),className:"px-2 py-1 text-xs rounded-lg bg-green-500 text-white hover:bg-green-600",children:"✅"}),a.jsx("button",{onClick:()=>g(o._id,"reject",o.sectionId),className:"px-2 py-1 text-xs rounded-lg bg-red-500 text-white hover:bg-red-600",children:"❌"})]})]},o._id)}):a.jsx("li",{className:"text-sm text-gray-500",children:"No pending invites"})})]})})}const Fr=cr.memo(({user:e,menuOpen:r,setMenuOpen:t})=>{const{toggleTheme:i,theme:s}=v.useContext(gr),g=dr(),[l,o]=v.useState(!1),[n,d]=v.useState(0),u=()=>{try{g(hr(ur.get("token")))}catch(b){console.log(b,"logout")}},f=()=>{o(!0),d(0)},{enqueueSnackbar:x}=pr();return a.jsxs(a.Fragment,{children:[a.jsx("header",{className:"relative h-[59px]",children:a.jsxs("nav",{className:`fixed shadow-sm bg-white dark:bg-support dark:text-gray-50 bg-blend-difference text-gray-600 h-[59px] items-center pr-5 pl-2 flex justify-between z-40 w-full top-0 dark:bg-[${$r}]`,children:[a.jsx("div",{className:"lg:hidden",children:a.jsx(yr,{onClick:()=>t(!r)})}),a.jsx("div",{className:"flex md:ml-[100px] gap-1 items-center",children:a.jsx(j,{to:"/",children:a.jsx("img",{src:mr,className:"h-10",alt:"Logo"})})}),a.jsx("div",{className:"flex items-center gap-3",children:e?a.jsxs(a.Fragment,{children:[a.jsx(S,{"aria-label":"notifications",onClick:f,children:a.jsx(Br,{badgeContent:n,color:"error",overlap:"circular",children:a.jsx(Tr,{})})}),a.jsx(S,{onClick:u,children:a.jsx(Or,{})})]}):a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(j,{to:"/login",className:"text-sm font-medium hover:underline",children:"Login"}),a.jsx(U,{orientation:"vertical",flexItem:!0,sx:{bgcolor:"grey.500"}}),a.jsx(j,{to:"/register",className:"text-sm font-medium hover:underline",children:"Signup"})]})})]})}),a.jsx(Ir,{userId:e==null?void 0:e._id,notificationOpen:l,setNotificationOpen:o})]})});export{Fr as H};
