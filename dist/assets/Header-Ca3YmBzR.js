import{ai as Y,ah as rr,r as x,aj as er,b5 as I,a7 as ar,a5 as S,j as a,b2 as c,ak as tr,al as or,b3 as ir,e as nr,b as sr,B as lr,R as cr,bA as gr,u as dr,a as O,o as pr,I as k,ae as mr,af as hr}from"./index-DuMHTSdw.js";import{u as ur}from"./useQuery-BvtePg6D.js";import{u as fr,G as vr}from"./api-Lr9EbcyZ.js";import{D as xr}from"./Drawer-C37bOGjO.js";import{D as w}from"./Divider-E5mG4O13.js";import{S as br,P as yr}from"./ShortText-DfIOWG_O.js";import{u as A}from"./usePreviousProps-Cuv5B9Ha.js";function Or(e){const{badgeContent:r,invisible:t=!1,max:i=99,showZero:s=!1}=e,g=A({badgeContent:r,max:i});let l=t;t===!1&&r===0&&!s&&(l=!0);const{badgeContent:o,max:n=i}=l?g:e,d=o&&Number(o)>n?`${n}+`:o;return{badgeContent:o,invisible:l,max:n,displayValue:d}}function jr(e){return rr("MuiBadge",e)}const p=Y("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),j=10,C=4,Cr=e=>{const{color:r,anchorOrigin:t,invisible:i,overlap:s,variant:g,classes:l={}}=e,o={root:["root"],badge:["badge",g,i&&"invisible",`anchorOrigin${c(t.vertical)}${c(t.horizontal)}`,`anchorOrigin${c(t.vertical)}${c(t.horizontal)}${c(s)}`,`overlap${c(s)}`,r!=="default"&&`color${c(r)}`]};return tr(o,jr,l)},Nr=S("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,r)=>r.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),Rr=S("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.badge,r[t.variant],r[`anchorOrigin${c(t.anchorOrigin.vertical)}${c(t.anchorOrigin.horizontal)}${c(t.overlap)}`],t.color!=="default"&&r[`color${c(t.color)}`],t.invisible&&r.invisible]}})(or(({theme:e})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:j*2,lineHeight:1,padding:"0 6px",height:j*2,borderRadius:j,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen}),variants:[...Object.entries(e.palette).filter(ir(["contrastText"])).map(([r])=>({props:{color:r},style:{backgroundColor:(e.vars||e).palette[r].main,color:(e.vars||e).palette[r].contrastText}})),{props:{variant:"dot"},style:{borderRadius:C,height:C*2,minWidth:C*2,padding:0}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${p.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${p.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${p.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${p.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${p.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${p.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${p.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${p.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})}}]})));function L(e){return{vertical:(e==null?void 0:e.vertical)??"top",horizontal:(e==null?void 0:e.horizontal)??"right"}}const Pr=x.forwardRef(function(r,t){const i=er({props:r,name:"MuiBadge"}),{anchorOrigin:s,className:g,classes:l,component:o,components:n={},componentsProps:d={},children:u,overlap:f="rectangular",color:v="default",invisible:U=!1,max:_=99,badgeContent:N,slots:m,slotProps:h,showZero:R=!1,variant:b="standard",...F}=i,{badgeContent:P,invisible:E,max:M,displayValue:V}=Or({max:_,invisible:U,badgeContent:N,showZero:R}),W=A({anchorOrigin:L(s),color:v,overlap:f,variant:b,badgeContent:N}),B=E||P==null&&b!=="dot",{color:G=v,overlap:H=f,anchorOrigin:q,variant:T=b}=B?W:i,Q=L(q),$=T!=="dot"?V:void 0,y={...i,badgeContent:P,invisible:B,max:M,displayValue:$,showZero:R,anchorOrigin:Q,color:G,overlap:H,variant:T},z=Cr(y),D={slots:{root:(m==null?void 0:m.root)??n.Root,badge:(m==null?void 0:m.badge)??n.Badge},slotProps:{root:(h==null?void 0:h.root)??d.root,badge:(h==null?void 0:h.badge)??d.badge}},[K,Z]=I("root",{elementType:Nr,externalForwardedProps:{...D,...F},ownerState:y,className:ar(z.root,g),ref:t,additionalProps:{as:o}}),[J,X]=I("badge",{elementType:Rr,externalForwardedProps:D,ownerState:y,className:z.badge});return a.jsxs(K,{...Z,children:[u,a.jsx(J,{...X,children:$})]})}),Br=nr(a.jsx("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"}),"Notifications"),Tr="#1d1e20",$r=async e=>(await fr.get(vr.GET_USER_INVITE+e)).data,zr=({userId:e})=>ur({queryKey:["inviteData",e],queryFn:()=>$r(e),onSuccess:(r,t,i)=>{i.queryClient.invalidateQueries(["inviteData",e]),i.queryClient.invalidateQueries(["groupData",e])}});function Dr({notificationOpen:e,setNotificationOpen:r,userId:t,refreshInvites:i}){var l;const{data:s}=zr({userId:t}),g=async(o,n,d)=>{try{await sr.post(lr+"/api/data/invites/respond",{inviteId:o,accept:n==="accept",section:d},{withCredentials:!0})}catch(u){console.error("Error responding to invite:",u)}};return a.jsx(xr,{anchor:"right",open:e,onClose:()=>r(!1),children:a.jsxs("div",{className:"w-80 p-4",children:[a.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Notifications"}),a.jsx(w,{className:"mb-2"}),a.jsx("ul",{className:"space-y-4 mt-3",children:(l=s==null?void 0:s.data)!=null&&l.length?s.data.map(o=>{var n;return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl shadow-sm border",children:[a.jsxs("div",{className:"text-sm",children:[a.jsxs("p",{className:"font-medium",children:[(n=o.invitedBy)==null?void 0:n.name," invited you to join a group"]}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Role: ",o.role," ·"," ",new Date(o.createdAt).toLocaleString()]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>g(o._id,"accept",o.sectionId),className:"px-2 py-1 text-xs rounded-lg bg-green-500 text-white hover:bg-green-600",children:"✅"}),a.jsx("button",{onClick:()=>g(o._id,"reject",o.sectionId),className:"px-2 py-1 text-xs rounded-lg bg-red-500 text-white hover:bg-red-600",children:"❌"})]})]},o._id)}):a.jsx("li",{className:"text-sm text-gray-500",children:"No pending invites"})})]})})}const _r=cr.memo(({user:e,menuOpen:r,setMenuOpen:t})=>{const{toggleTheme:i,theme:s}=x.useContext(gr),g=dr(),[l,o]=x.useState(!1),[n,d]=x.useState(0),u=()=>{try{g(mr(hr.get("token")))}catch(v){console.log(v,"logout")}},f=()=>{o(!0),d(0)};return a.jsxs(a.Fragment,{children:[a.jsx("header",{className:"relative h-[59px]",children:a.jsxs("nav",{className:`fixed shadow-sm bg-white dark:bg-support dark:text-gray-50 bg-blend-difference text-gray-600 h-[59px] items-center pr-5 pl-2 flex justify-between z-40 w-full top-0 dark:bg-[${Tr}]`,children:[a.jsx("div",{className:"lg:hidden",children:a.jsx(br,{onClick:()=>t(!r)})}),a.jsx("div",{className:"flex md:ml-[100px] gap-1 items-center",children:a.jsx(O,{to:"/",children:a.jsx("img",{src:pr,className:"h-10",alt:"Logo"})})}),a.jsx("div",{className:"flex items-center gap-3",children:e?a.jsxs(a.Fragment,{children:[a.jsx(k,{"aria-label":"notifications",onClick:f,children:a.jsx(Pr,{badgeContent:n,color:"error",overlap:"circular",children:a.jsx(Br,{})})}),a.jsx(k,{onClick:u,children:a.jsx(yr,{})})]}):a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(O,{to:"/login",className:"text-sm font-medium hover:underline",children:"Login"}),a.jsx(w,{orientation:"vertical",flexItem:!0,sx:{bgcolor:"grey.500"}}),a.jsx(O,{to:"/register",className:"text-sm font-medium hover:underline",children:"Signup"})]})})]})}),a.jsx(Dr,{userId:e==null?void 0:e._id,notificationOpen:l,setNotificationOpen:o})]})});export{_r as H};
