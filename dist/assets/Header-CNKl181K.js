import{w as Y,v as ee,r as b,x as te,aG as S,z as re,y as A,j as t,aD as d,A as ae,ao as oe,aE as ne,h as ie,e as se,d as le,B as ce,R as de,be as ge,u as pe,c as he,b as f,o as me,I as w,al as xe,am as ue}from"./index-DA7-g0Ll.js";import{D as ve}from"./Drawer-JjNZNglL.js";import{D as F}from"./Divider-OcCMvkHj.js";import{u as fe}from"./useQuery-DFPHri9n.js";import{u as be,G as ye}from"./api-BqAjmFTP.js";import{C as je}from"./Coin-CEX1Q61F.js";import{S as Oe}from"./ShortText-CA5kHEPa.js";import{T as Ne}from"./Tooltip-DGBq536Y.js";import{u as U}from"./usePreviousProps-bFgXBqTv.js";import{P as Ce}from"./PowerSettingsNew-Hbugbse4.js";function Re(r){const{badgeContent:e,invisible:o=!1,max:i=99,showZero:g=!1}=r,p=U({badgeContent:e,max:i});let s=o;o===!1&&e===0&&!g&&(s=!0);const{badgeContent:n,max:l=i}=s?p:r,a=n&&Number(n)>l?`${l}+`:n;return{badgeContent:n,invisible:s,max:l,displayValue:a}}function Be(r){return ee("MuiBadge",r)}const x=Y("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),N=10,C=4,Pe=r=>{const{color:e,anchorOrigin:o,invisible:i,overlap:g,variant:p,classes:s={}}=r,n={root:["root"],badge:["badge",p,i&&"invisible",`anchorOrigin${d(o.vertical)}${d(o.horizontal)}`,`anchorOrigin${d(o.vertical)}${d(o.horizontal)}${d(g)}`,`overlap${d(g)}`,e!=="default"&&`color${d(e)}`]};return ae(n,Be,s)},Te=A("span",{name:"MuiBadge",slot:"Root",overridesResolver:(r,e)=>e.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),De=A("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(r,e)=>{const{ownerState:o}=r;return[e.badge,e[o.variant],e[`anchorOrigin${d(o.anchorOrigin.vertical)}${d(o.anchorOrigin.horizontal)}${d(o.overlap)}`],o.color!=="default"&&e[`color${d(o.color)}`],o.invisible&&e.invisible]}})(oe(({theme:r})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:r.typography.fontFamily,fontWeight:r.typography.fontWeightMedium,fontSize:r.typography.pxToRem(12),minWidth:N*2,lineHeight:1,padding:"0 6px",height:N*2,borderRadius:N,zIndex:1,transition:r.transitions.create("transform",{easing:r.transitions.easing.easeInOut,duration:r.transitions.duration.enteringScreen}),variants:[...Object.entries(r.palette).filter(ne(["contrastText"])).map(([e])=>({props:{color:e},style:{backgroundColor:(r.vars||r).palette[e].main,color:(r.vars||r).palette[e].contrastText}})),{props:{variant:"dot"},style:{borderRadius:C,height:C*2,minWidth:C*2,padding:0}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${x.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${x.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${x.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${x.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${x.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${x.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${x.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${x.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:r.transitions.create("transform",{easing:r.transitions.easing.easeInOut,duration:r.transitions.duration.leavingScreen})}}]})));function L(r){return{vertical:(r==null?void 0:r.vertical)??"top",horizontal:(r==null?void 0:r.horizontal)??"right"}}const Ie=b.forwardRef(function(e,o){const i=te({props:e,name:"MuiBadge"}),{anchorOrigin:g,className:p,classes:s,component:n,components:l={},componentsProps:a={},children:c,overlap:h="rectangular",color:m="default",invisible:R=!1,max:y=99,badgeContent:B,slots:u,slotProps:v,showZero:P=!1,variant:j="standard",..._}=i,{badgeContent:T,invisible:M,max:E,displayValue:H}=Re({max:y,invisible:R,badgeContent:B,showZero:P}),Z=U({anchorOrigin:L(g),color:m,overlap:h,variant:j,badgeContent:B}),D=M||T==null&&j!=="dot",{color:V=m,overlap:G=h,anchorOrigin:W,variant:I=j}=D?Z:i,q=L(W),$=I!=="dot"?H:void 0,O={...i,badgeContent:T,invisible:D,max:E,displayValue:$,showZero:P,anchorOrigin:q,color:V,overlap:G,variant:I},z=Pe(O),k={slots:{root:(u==null?void 0:u.root)??l.Root,badge:(u==null?void 0:u.badge)??l.Badge},slotProps:{root:(v==null?void 0:v.root)??a.root,badge:(v==null?void 0:v.badge)??a.badge}},[Q,K]=S("root",{elementType:Te,externalForwardedProps:{...k,..._},ownerState:O,className:re(z.root,p),ref:o,additionalProps:{as:n}}),[J,X]=S("badge",{elementType:De,externalForwardedProps:k,ownerState:O,className:z.badge});return t.jsxs(Q,{...K,children:[c,t.jsx(J,{...X,children:$})]})}),$e=ie("Cart20Regular","20",["M3 3.5c0-.28.22-.5.5-.5h.44c.72 0 1.14.47 1.38.94.17.32.29.72.39 1.06H16a1 1 0 0 1 .96 1.27l-1.5 5.28A2 2 0 0 1 13.55 13H8.46a2 2 0 0 1-1.93-1.47L5.9 9.17l-.01-.03-1.03-3.5-.1-.33a5.2 5.2 0 0 0-.32-.91c-.16-.31-.3-.4-.5-.4H3.5a.5.5 0 0 1-.5-.5Zm3.84 5.37.66 2.4a1 1 0 0 0 .96.73h5.08a1 1 0 0 0 .96-.73L16 6H6l.84 2.87ZM10 15.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm-1 0a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0Zm6 0a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm-1 0a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0Z"]),ze=se(t.jsx("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"}),"Notifications"),ke="#1d1e20";function Se({notificationOpen:r,setNotificationOpen:e,data:o,userId:i,refreshInvites:g}){var l;const p=async(a,c,h)=>{try{await le.post(ce+"/api/data/invites/respond",{inviteId:a,accept:c==="accept",section:h},{withCredentials:!0}),g&&g(),window.location.reload()}catch(m){console.error("Error responding to invite:",m)}},s=a=>a.invitedBy&&a.role,n=a=>a.text&&!a.invitedBy;return t.jsx(ve,{anchor:"right",open:r,onClose:()=>e(!1),children:t.jsxs("div",{className:"w-80 p-4",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Notifications"}),t.jsx(F,{}),(l=o==null?void 0:o.data)!=null&&l.length?o.data.map(a=>{var c,h,m;return t.jsxs("div",{className:"py-3 border-b",children:[s(a)&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-2",children:[t.jsxs("p",{className:"text-sm font-medium",children:[(c=a.invitedBy)==null?void 0:c.name," invited you to join"," ",((h=a.groupId)==null?void 0:h.groupName)||"a group"]}),t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Role: ",a.role," ·"," ",new Date(a.createdAt).toLocaleString()]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>p(a._id,"accept",a.sectionId),className:"px-2 py-1 text-xs rounded-lg bg-green-500 text-white hover:bg-green-600",children:"✅ Accept"}),t.jsx("button",{onClick:()=>p(a._id,"reject",a.sectionId),className:"px-2 py-1 text-xs rounded-lg bg-red-500 text-white hover:bg-red-600",children:"❌ Reject"})]}),a.text&&t.jsx("div",{className:"mt-2 p-2 bg-gray-50 rounded text-xs",children:a.text})]}),n(a)&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-2",children:[t.jsxs("p",{className:"text-sm font-medium",children:["Message from ",((m=a.userId)==null?void 0:m.name)||"Unknown"]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(a.createdAt).toLocaleString()})]}),t.jsx("div",{className:"p-2 text-xs bg-blue-50 rounded ",children:a.text})]}),!s(a)&&!n(a)&&t.jsx("div",{className:"text-sm text-gray-500",children:"Unknown notification type"})]},a._id)}):t.jsx("div",{className:"text-center py-8 text-gray-500",children:t.jsx("p",{children:"No pending notifications"})})]})})}const we=async r=>(await be.get(ye.GET_USER_INVITE+r)).data,Le=({userId:r})=>fe({queryKey:["inviteData",r],queryFn:()=>we(r),onSuccess:(e,o,i)=>{i.queryClient.invalidateQueries(["inviteData",r]),i.queryClient.invalidateQueries(["groupData",r])}}),We=de.memo(({user:r,menuOpen:e,setMenuOpen:o})=>{const{toggleTheme:i,theme:g}=b.useContext(ge),p=pe(),[s,n]=b.useState(!1),[l,a]=b.useState(0),{data:c}=Le(r?{userId:r._id}:{}),h=()=>{try{p(xe(ue.get("token")))}catch(y){console.log(y,"logout")}},m=()=>{n(!0),a(0)},{enqueueSnackbar:R}=he();return t.jsxs(t.Fragment,{children:[t.jsx("header",{className:"relative h-[59px]",children:t.jsxs("nav",{className:`fixed shadow-sm bg-white dark:bg-support dark:text-gray-50 bg-blend-difference text-gray-600 h-[59px] items-center pr-5 pl-2 flex justify-between z-40 w-full top-0 dark:bg-[${ke}]`,children:[t.jsx("div",{className:"lg:hidden",children:t.jsx(Oe,{onClick:()=>o(!e)})}),t.jsx("div",{className:"flex md:ml-[100px] gap-1 items-center",children:t.jsx(f,{to:"/",children:t.jsx("img",{src:me,className:"h-10",alt:"Logo"})})}),t.jsxs("div",{className:"flex items-center gap-3",children:[(r==null?void 0:r.coins)&&t.jsxs("div",{className:"flex gap-1 rounded-lg items-center",children:[t.jsx(je,{}),t.jsx("div",{className:"text-sm",children:t.jsx("span",{children:r==null?void 0:r.coins})})]}),t.jsx(Ne,{title:"But More Coins",sx:{cursor:"pointer"},children:t.jsx(f,{to:"/user/coins-add",children:t.jsx($e,{style:{cursor:"pointer"}})})}),r?t.jsxs(t.Fragment,{children:[t.jsx(w,{"aria-label":"notifications",onClick:m,children:t.jsxs(Ie,{badgeContent:l,color:"error",sx:{position:"relative"},overlap:"circular",children:[t.jsx(ze,{}),t.jsx("span",{className:"text-xs bg-red-500 text-white -right-2  h-4 rounded-full absolute w-4",children:JSON.stringify(c==null?void 0:c.data.length)||0})]})}),t.jsx(w,{onClick:h,children:t.jsx(Ce,{})})]}):t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx(f,{to:"/login",className:"text-sm font-medium hover:underline",children:"Login"}),t.jsx(F,{orientation:"vertical",flexItem:!0,sx:{bgcolor:"grey.500"}}),t.jsx(f,{to:"/register",className:"text-sm font-medium hover:underline",children:"Signup"})]})]})]})}),t.jsx(Se,{data:c,userId:r==null?void 0:r._id,notificationOpen:s,setNotificationOpen:n})]})});export{We as H};
