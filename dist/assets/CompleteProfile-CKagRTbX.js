import{e as L,j as a,a as G,r as i,u as M,d as v,B as j,m as k,bg as q,I as y,C as D,o as U}from"./index-Cw-TTt2Q.js";import{p as d}from"./profileData-DThhwKJj.js";import{T as o}from"./TextField-M4TmMMzK.js";import{A as $}from"./Avatar-kX7dBh8X.js";import{A as c}from"./Autocomplete-yQZ3YKkD.js";import"./Select-gCma7GWS.js";import"./Menu-BUiVb5Mu.js";import"./index-BQr0Oul9.js";import"./Grow-BjMe797Z.js";import"./Paper-DEUqRhru.js";import"./mergeSlotProps-CIWjKpOs.js";import"./index-B5DdrQpV.js";import"./extendSxProp-C6ZwBt7c.js";import"./Close-CwbdtqUO.js";import"./usePreviousProps-Dd8udzH2.js";import"./Popper-CYn7jHni.js";import"./Chip-ChYy7A6Y.js";const F=L(a.jsx("path",{d:"m14.06 9.02.92.92L5.92 19H5v-.92zM17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29m-3.6 3.19L3 17.25V21h3.75L17.81 9.94z"}),"EditOutlined");function re(){const{user:s}=G(e=>e.auth),[u,P]=i.useState(1),[w,p]=i.useState(!1),b=M(),S=3,[r,z]=i.useState({avatar:(s==null?void 0:s.avatar)||"",name:(s==null?void 0:s.name)||"",phone:(s==null?void 0:s.phone)||"",program:(s==null?void 0:s.program)||"",specialisation:(s==null?void 0:s.specialisation)||"",semester:(s==null?void 0:s.semester)||"",yearOfGraduation:(s==null?void 0:s.yearOfGraduation)||"",university:(s==null?void 0:s.university)||"",password:""}),n=(e,t)=>{z(m=>({...m,[e]:t}))},x=e=>/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/.test(e),C=()=>{var e,t;return u===1?((e=r.name)==null?void 0:e.trim())&&((t=r.password)==null?void 0:t.trim())&&x(r.password):u===2?r.program&&r.specialisation&&r.yearOfGraduation&&r.semester&&r.university:!0};i.useEffect(()=>{u>S&&h()},[u]);const h=e=>{e==null||e.preventDefault(),C()&&v.put(`${j}/api/profile/complete`,{...r,id:s._id},{withCredentials:!0}).then(t=>{b(k(t.data.user))}).catch(t=>console.log(t))},f=i.useMemo(()=>q(async e=>{if(e){g(!0);try{const m=(await v.get(`${j}/api/university/${e}`,{withCredentials:!0})).data.map(E=>E.name);O(m.includes("Others")?m:[...m,"Others"])}catch(t){console.error("Error fetching universities:",t)}finally{g(!1)}}},500),[]),[N,O]=i.useState([]),[A,g]=i.useState(!1),l=i.useMemo(()=>d.programs.find(e=>e.name===r.program),[r.program]),I=i.useMemo(()=>l!=null&&l.maxSemester?Array.from({length:l.maxSemester},(e,t)=>(t+1).toString()):[],[l]);return i.useEffect(()=>{f(r.university)},[r.university,f]),a.jsxs(a.Fragment,{children:[w&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-40"}),a.jsxs("div",{className:"fixed z-50 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white p-6 rounded-xl shadow-xl w-[90%] max-w-lge",children:[a.jsx("div",{className:"flex justify-end",children:a.jsx(y,{onClick:()=>p(!1),children:a.jsx(D,{})})}),a.jsx("div",{className:"grid grid-cols-4 gap-2",children:d.avatars.map((e,t)=>a.jsx("img",{src:e,onClick:()=>{n("avatar",e),p(!1)},className:"hover:shadow-lg hover:scale-105 transition-all duration-100 cursor-pointer rounded-full h-[100px] w-[100px]"},t))})]})]}),a.jsxs("main",{className:"bg-white gap-3 xs:p-5  flex justify-center items-center h-screen",children:[a.jsx("img",{className:"absolute min-w top-2 left-2 h-10",src:U,alt:""}),a.jsxs("form",{className:"flex-col flex gap-4 ",onSubmit:h,children:[a.jsxs("div",{className:"flex gap-3 w-full",children:[a.jsxs("div",{className:"flex flex-1 gap-4 justify-center flex-col",children:[a.jsx("h1",{className:"text-3xl lg:mb-0 mb-42 text-[#111827] text-center font-[Lato]",children:"Profile Details"}),a.jsx(o,{size:"small",label:"Full Name",variant:"outlined",value:r.name,onChange:e=>n("name",e.target.value),fullWidth:!0,required:!0})]}),a.jsxs("div",{className:"relative justify-center flex",children:[a.jsx($,{src:r.avatar,sx:{width:100,height:100}}),a.jsx(y,{onClick:()=>p(!0),sx:{position:"absolute",bottom:-10,marginLeft:"110px"},children:a.jsx(F,{})})]})]}),a.jsx(o,{size:"small",label:"Set up a Password",variant:"outlined",type:"password",value:r.password,onChange:e=>n("password",e.target.value),fullWidth:!0,required:!0,error:!!r.password&&!x(r.password),helperText:r.password&&!x(r.password)?"Min 8 characters with at least 1 letter, 1 number, and 1 special character.":""}),a.jsx(c,{size:"small",options:d.programs.map(e=>e.name),value:r.program,onChange:(e,t)=>n("program",t),renderInput:e=>a.jsx(o,{size:"small",...e,required:!0,label:"Program",variant:"outlined"})}),a.jsx(c,{size:"small",options:d.specialization,value:r.specialisation,onChange:(e,t)=>n("specialisation",t),renderInput:e=>a.jsx(o,{size:"small",...e,required:!0,label:"Specialisation",variant:"outlined"})}),a.jsx(c,{size:"small",options:d.yearofgraduation,value:r.yearOfGraduation,onChange:(e,t)=>n("yearOfGraduation",t),renderInput:e=>a.jsx(o,{size:"small",...e,required:!0,label:"Year of Graduation",variant:"outlined"})}),a.jsx(c,{size:"small",options:I,value:r.semester,onChange:(e,t)=>n("semester",t),renderInput:e=>a.jsx(o,{size:"small",...e,required:!0,label:"Semester",variant:"outlined"})}),a.jsx(c,{size:"small",loading:A,options:N,value:r.university,onChange:(e,t)=>n("university",t),onInputChange:(e,t)=>f(t),freeSolo:!1,renderInput:e=>a.jsx(o,{...e,required:!0,label:"University",variant:"outlined"})}),a.jsxs("div",{className:"flex animate-slide-left flex-col gap-4",children:[a.jsxs("p",{className:"text-xs",children:["By continuing you agree to our"," ",a.jsx("a",{href:"/",className:"underline",children:"Terms & Conditions"})]}),a.jsx("button",{type:"submit",className:"py-3 mt-2 bg-black text-white rounded-full",children:"Submit Profile"})]})]})]})]})}export{re as default};
