import{r as s,j as t,O as L,D as C,d as b,B as x}from"./index-Yqgfe9qv.js";import{B as y}from"./Box-B7g9SzdQ.js";import{T as g}from"./Typography-D4bi1yCd.js";import{a as $}from"./Menu-DpdFufhw.js";import{L as E,a as R}from"./ListItemText-B5imaWnj.js";import{B as I}from"./Button-C0PomnAW.js";import"./extendSxProp-BR2Zb8Yq.js";import"./index-De_OcGwR.js";import"./index-Dz3dmmRP.js";import"./useSlotProps-Cr26nE7z.js";import"./Paper-A2apxz71.js";import"./Grow-B7ERlCEw.js";import"./mergeSlotProps-Brez3GbD.js";import"./Select-oMtsOusi.js";import"./MenuItem-BXFmYug5.js";import"./dividerClasses-B490F5d6.js";const M={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90%",maxWidth:800,maxHeight:"80vh",bgcolor:"background.paper",borderRadius:2,boxShadow:24,p:4,overflowY:"auto"};function Q({open:l,onSuccess:j,onClose:m,testId:P,sectionId:S}){const[n,f]=s.useState([]),[u,p]=s.useState(1),[a,h]=s.useState(!1),[c,d]=s.useState(!0),i=s.useRef(),v=s.useCallback(e=>{a||(i.current&&i.current.disconnect(),i.current=new IntersectionObserver(r=>{r[0].isIntersecting&&c&&p(o=>o+1)}),e&&i.current.observe(e))},[a,c]);s.useEffect(()=>{l&&(async()=>{h(!0);try{const o=(await b.get(`${x}/api/admin/problems?search=&category=&difficulty=&isAvailable=&page=${u}&limit=10&sortBy=createdAt&sortOrder=desc`,{withCredentials:!0})).data.data||[];f(B=>[...B,...o]),d(o.length>0)}catch(r){console.error("Error fetching problems:",r),d(!1)}finally{h(!1)}})()},[u,l]);const w=async e=>{try{await b.post(`${x}/api/admin/tests/${P}/sections/${S}/problem`,{problemId:e},{withCredentials:!0}),alert("Problem added successfully!"),j(),m()}catch(r){console.error("Failed to add problem:",r),alert("Failed to add problem")}},A=()=>{f([]),p(1),d(!0),m()};return t.jsx(L,{open:l,onClose:A,children:t.jsxs(y,{sx:M,children:[t.jsx(g,{variant:"h6",mb:2,children:"Select Problem to Add"}),t.jsx($,{children:n.map((e,r)=>{const o=n.length===r+1;return t.jsx(E,{ref:o?v:null,divider:!0,secondaryAction:t.jsx(I,{size:"small",variant:"contained",onClick:()=>w(e._id),children:"Add"}),children:t.jsx(R,{primary:e.title,secondary:`Difficulty: ${e.difficulty}`})},e._id)})}),a&&t.jsx(y,{className:"flex justify-center mt-4",children:t.jsx(C,{size:24})}),!a&&!c&&n.length===0&&t.jsx(g,{className:"text-center mt-4",color:"textSecondary",children:"No problems found."})]})})}export{Q as default};
