import{d as m,B as u,j as e,c as p,r as h,b as g,I as j,L as b}from"./index-CYu2G9Yr.js";import{u as f}from"./useQuery-DlMBgOoi.js";import{D as v}from"./Delete-DJjIBZhX.js";const N=async({queryKey:a})=>{const[s,{endpoint:i,params:n}]=a;return(await m.get(`${u}/api/admin/${i}`,{params:n,withCredentials:!0})).data},y=({filters:a,setFilters:s,type:i})=>{const n=t=>{s({...a,[t.target.name]:t.target.value,page:1})};return e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[e.jsx("input",{name:"search",value:a.search,onChange:n,placeholder:`Search ${i} by title`,className:"border p-2 rounded-md w-48"}),e.jsxs("select",{name:"category",onChange:n,value:a.category,className:"border p-2 rounded-md",children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"Aptitude",children:"Aptitude"}),e.jsx("option",{value:"Core",children:"Core"})]}),i==="quiz"||i=="problems"&&e.jsxs("select",{name:"difficulty",onChange:n,value:a.difficulty,className:"border p-2 rounded-md",children:[e.jsx("option",{value:"",children:"All Difficulty"}),e.jsx("option",{value:"Easy",children:"Easy"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Hard",children:"Hard"})]}),e.jsxs("select",{name:"isAvailable",onChange:n,value:a.isAvailable,className:"border p-2 rounded-md",children:[e.jsx("option",{value:"",children:"Availability"}),e.jsx("option",{value:"true",children:"Available"}),e.jsx("option",{value:"false",children:"Unavailable"})]})]})},w=({data:a,type:s})=>{const{enqueueSnackbar:i}=p(),[n,t]=h.useState((a==null?void 0:a.data)||[]),o=async l=>{var r,x;try{await m.post(`${u}/api/admin/delete/${s}/${l}`),t(d=>d.filter(c=>c._id!==l)),i(`${s} deleted successfully`,{variant:"success"})}catch(d){console.error("Delete failed:",d);const c=((x=(r=d.response)==null?void 0:r.data)==null?void 0:x.message)||"Failed to delete. Try again.";i(c,{variant:"error"})}};return n.length?e.jsx("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-sm",children:"Title"}),s==="test"&&e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-sm",children:"Category"}),s==="problems"&&e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-sm",children:"Difficulty"}),s==="test"&&e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-sm",children:"Duration"}),s==="quiz"||s==="test"||s==="problems"?e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-sm",children:"Slug"}):s==="questionbanks"?null:e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-sm",children:"Campus"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-sm",children:"Edit"}),e.jsx("th",{className:"px-6 py-3 text-left font-semibold text-sm",children:"Delete"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:n.map(l=>{var r;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:l.title||l.name}),s==="test"&&e.jsx("td",{className:"px-6 py-4",children:l.category}),s==="problems"&&e.jsx("td",{className:"px-6 py-4",children:l.difficulty}),s==="test"&&e.jsxs("td",{className:"px-6 py-4",children:[l.duration," mins"]}),s==="quiz"||s==="test"||s==="problems"?e.jsx("td",{className:"px-6 py-4",children:l.slug}):s==="questionbanks"?null:e.jsx("td",{className:"px-6 py-4",children:(r=l==null?void 0:l.groupId)==null?void 0:r.groupName}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(g,{className:"underline",to:`/admin/edit/${s}/${l._id}`,children:"Edit"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(j,{onClick:()=>o(l._id),children:e.jsx(v,{})})})]},l._id)})})]})}):e.jsxs("div",{className:"text-center",children:["No ",s,"s found."]})},$=({type:a})=>{const[s,i]=h.useState({search:"",category:"",difficulty:"",isAvailable:"",page:1,limit:10,sortBy:"createdAt",sortOrder:"desc"}),n=["admin-"+a,{endpoint:`${a}`,params:s}],{data:t,isLoading:o}=f({queryKey:n,queryFn:N,staleTime:3e5,cacheTime:36e5});return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("div",{className:"sticky top-0 z-20 bg-white border-b shadow-sm p-4",children:e.jsxs("h1",{className:"text-2xl font-bold capitalize text-gray-800",children:[a," Management"]})}),e.jsx("div",{className:"p-4 mx-auto",children:e.jsx(y,{filters:s,setFilters:i,type:a})}),o?e.jsx(b,{}):e.jsxs("div",{className:"px-4 pb-4 mx-auto",children:[e.jsx(w,{data:t,type:a}),e.jsxs("div",{className:"mt-6 flex justify-between items-center",children:[e.jsx("button",{disabled:s.page<=1,onClick:()=>i({...s,page:s.page-1}),className:"px-5 py-2 rounded bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"← Prev"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",t==null?void 0:t.page," of ",t==null?void 0:t.totalPages]}),e.jsx("button",{disabled:s.page>=(t==null?void 0:t.totalPages),onClick:()=>i({...s,page:s.page+1}),className:"px-5 py-2 rounded bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Next →"})]})]})]})};export{$ as Q};
