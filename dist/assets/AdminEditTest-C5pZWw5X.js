const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddTestProblemModal-DGt0TRgF.js","assets/index-Dgxf8jnM.js","assets/index-WrRTqBRO.css","assets/Box-m-LtyOOm.js","assets/extendSxProp-DfyTISa-.js","assets/Typography-CVArGf37.js","assets/index-C6iZhDE_.js","assets/Menu-DlfYpJNn.js","assets/index-DdPFbzDz.js","assets/Grow-Bpnmt4GB.js","assets/Paper-lVDyPjmC.js","assets/mergeSlotProps-B3zE2hsj.js","assets/ListItemText-uDUdSoPH.js","assets/Select-BIrZgrZ7.js","assets/MenuItem-Zy46vF7i.js","assets/dividerClasses-BK2cx7nh.js","assets/Button-CGcYMRrR.js","assets/AddTestSectionQuestionsModal-Ke5S3htd.js","assets/xlsx-CygJKsBP.js","assets/Upload-CvAidEYA.js","assets/TextField-DryysFKQ.js","assets/Radio-DNv5_SgU.js","assets/SwitchBase-XkxpVh_4.js","assets/Checkbox-Bgym7WqB.js"])))=>i.map(i=>d[i]);
import{i as L,r as l,j as e,a0 as V,b as x,B as g,ab as Q}from"./index-Dgxf8jnM.js";import{A as B}from"./Add-BEI6VEZ0.js";import{T as p}from"./Typography-CVArGf37.js";import{T as n}from"./TextField-DryysFKQ.js";import{M as r}from"./MenuItem-Zy46vF7i.js";import{B as u}from"./Button-CGcYMRrR.js";import{P as R}from"./Paper-lVDyPjmC.js";import{A as G,a as U,b as H}from"./AccordionSummary-B903_q8-.js";import"./index-C6iZhDE_.js";import"./extendSxProp-DfyTISa-.js";import"./Select-BIrZgrZ7.js";import"./Menu-DlfYpJNn.js";import"./index-DdPFbzDz.js";import"./Grow-Bpnmt4GB.js";import"./mergeSlotProps-B3zE2hsj.js";import"./dividerClasses-BK2cx7nh.js";const J=l.lazy(()=>Q(()=>import("./AddTestProblemModal-DGt0TRgF.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]))),K=l.lazy(()=>Q(()=>import("./AddTestSectionQuestionsModal-Ke5S3htd.js"),__vite__mapDeps([17,1,2,18,3,4,5,6,16,19,20,13,7,8,9,10,11,14,15,21,22,23])));function me(){const{id:o}=L(),[a,i]=l.useState(null),[w,M]=l.useState(!0),[j,E]=l.useState(null),[d,m]=l.useState({name:"",sectionType:"Quiz"}),[y,b]=l.useState(!1),[f,v]=l.useState(!1),[F,C]=l.useState(null),[$,N]=l.useState(null),k=s=>C(s),S=()=>C(null),I=s=>N(s),T=()=>N(null),h=async()=>{try{const s=await x.get(`${g}/api/admin/tests/${o}`,{withCredentials:!0});i(s.data.data)}catch{E("Failed to fetch test")}finally{M(!1)}};l.useEffect(()=>{h()},[o]);const D=async()=>{try{b(!0);const s=await x.post(`${g}/api/admin/tests/${o}/sections`,d,{withCredentials:!0});i(s.data.data),m({name:"",sectionType:"Quiz"})}catch(s){console.error("Failed to add section",s),alert("Failed to add section")}finally{b(!1)}},O=async()=>{try{v(!0);const s=await x.put(`${g}/api/admin/tests/update/${o}`,a,{withCredentials:!0});i(s.data.data)}catch(s){console.error("Failed to update test",s),alert("Failed to save changes")}finally{v(!1)}};return w?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(V,{})}):j?e.jsx(p,{color:"error",children:j}):e.jsxs("div",{className:"p-6 md:p-10 bg-gray-50 min-h-screen",children:[e.jsxs("h4",{className:"font-bold mb-6 text-gray-800 text-xl",children:["Edit Test - ",a.name]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsx(n,{size:"small",label:"Test Name",value:a.name,onChange:s=>i({...a,name:s.target.value}),fullWidth:!0}),e.jsx(n,{size:"small",label:"Duration (minutes)",type:"number",value:a.duration||"",onChange:s=>i({...a,duration:parseInt(s.target.value)}),fullWidth:!0}),e.jsx(n,{label:"Description",size:"small",value:a.description||"",onChange:s=>i({...a,description:s.target.value}),fullWidth:!0,multiline:!0,rows:3}),e.jsxs(n,{select:!0,size:"small",label:"Category",value:a.category,onChange:s=>i({...a,category:s.target.value}),fullWidth:!0,children:[e.jsx(r,{value:"Placements",children:"Placements"}),e.jsx(r,{value:"Gate",children:"Gate"})]}),e.jsxs(n,{select:!0,size:"small",label:"Visibility",value:a.visibility,onChange:s=>i({...a,visibility:s.target.value}),fullWidth:!0,children:[e.jsx(r,{value:"private",children:"Private"}),e.jsx(r,{value:"public",children:"Public"}),e.jsx(r,{value:"group",children:"Group"})]}),e.jsxs(n,{select:!0,size:"small",label:"Availability",value:a.isAvailable?"true":"false",onChange:s=>i({...a,isAvailable:s.target.value==="true"}),fullWidth:!0,children:[e.jsx(r,{value:"true",children:"Available"}),e.jsx(r,{value:"false",children:"Not Available"})]})]}),e.jsx(u,{variant:"contained",color:"primary",onClick:O,disabled:f,className:"mb-8",children:f?"Saving...":"Save Changes"}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h1",{className:"font-medium mb-2 pl-1 text-gray-700",children:"Add New Section"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(n,{size:"small",label:"Section Name",value:d.name,onChange:s=>m({...d,name:s.target.value})}),e.jsxs(n,{size:"small",select:!0,label:"Type",value:d.sectionType,onChange:s=>m({...d,sectionType:s.target.value}),children:[e.jsx(r,{value:"Quiz",children:"Quiz"}),e.jsx(r,{value:"Coding",children:"Coding"})]}),e.jsx(u,{variant:"contained",startIcon:e.jsx(B,{}),onClick:D,disabled:y||!d.name,children:y?"Adding...":"Add Section"})]})]}),e.jsx("h2",{className:"font-semibold pl-1 mt-6 mb-4 text-gray-700 text-lg",children:"Sections"}),a.sections.length===0&&e.jsx("p",{className:"text-gray-500 italic mb-4",children:"No sections added yet."}),a.sections.map((s,W)=>{var A,z,P,_;return e.jsxs(R,{className:"p-4 mb-4 shadow-sm border rounded-lg bg-white",children:[e.jsx(p,{className:"font-semibold text-lg",children:s.name}),e.jsxs(p,{variant:"body2",color:"textSecondary",children:["Type:"," ",s.sectionType==="Quiz"?`Quiz Questions ${((A=s.questionSet)==null?void 0:A.length)||0}`:`Coding Problems ${((z=s.problemset)==null?void 0:z.length)||0}`]}),e.jsxs("div",{className:"flex flex-col gap-4 mt-4",children:[s.sectionType==="Quiz"&&e.jsx(u,{size:"small",variant:"outlined",onClick:()=>I(s._id),children:"Add Questions"}),s.sectionType==="Coding"&&e.jsx(u,{size:"small",variant:"outlined",onClick:()=>k(s._id),children:"Add Problems"}),e.jsxs(G,{children:[e.jsx(U,{children:s.sectionType==="Quiz"?"View Questions":"View Problems"}),e.jsx(H,{children:s.sectionType==="Quiz"?(P=s.questionSet)!=null&&P.length?e.jsx("ul",{className:"list-disc ml-6 space-y-2 text-sm text-gray-800",children:s.questionSet.map((t,c)=>e.jsxs("li",{children:[e.jsx("strong",{children:t.question||`Question ${c+1}`}),e.jsx("br",{}),e.jsx("span",{className:"text-gray-600",children:"Type:"})," ",t.category,e.jsx("br",{}),t.difficulty&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"Difficulty:"})," ",t.difficulty,e.jsx("br",{})]}),t.marks&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"Marks:"})," ",t.marks]})]},t._id||c))}):e.jsx("p",{className:"text-gray-500 italic",children:"No questions added yet."}):(_=s.problemset)!=null&&_.length?e.jsx("ul",{className:"list-disc ml-6 space-y-2 text-sm text-gray-800",children:s.problemset.map((t,c)=>e.jsxs("li",{children:[e.jsx("strong",{children:t.title||`Problem ${c+1}`}),e.jsx("br",{}),t.difficulty&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"Difficulty:"})," ",t.difficulty,e.jsx("br",{})]}),Array.isArray(t.tags)&&t.tags.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"Tags:"})," ",t.tags.join(", ")]})]},t._id||c))}):e.jsx("p",{className:"text-gray-500 italic",children:"No problems added yet."})})]})]}),e.jsxs(l.Suspense,{fallback:e.jsx("div",{children:"Loading modal..."}),children:[$===s._id&&s.sectionType==="Quiz"&&e.jsx(K,{open:!0,onClose:T,testId:o,sectionId:s._id,onSuccess:()=>{h(),T()}}),F===s._id&&s.sectionType==="Coding"&&e.jsx(J,{open:!0,onClose:S,testId:o,sectionId:s._id,onSuccess:()=>{h(),S()}})]})]},W)})]})}export{me as default};
