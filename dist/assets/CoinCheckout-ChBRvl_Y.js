import{c as f,i as g,u as j,a as N,q as w,j as e,c9 as m,ca as v,cb as P}from"./index-W_7DnO0K.js";import{G as k}from"./Breadcrumb-ClNInogV.js";import"./useSlotProps-CTA75u8U.js";import"./Typography-BoyanTWv.js";import"./index-CdsCzFEO.js";import"./extendSxProp-x_8OfL-C.js";import"./Box-D9t7piey.js";function $(){const p=[{_id:1,price:99,coins:300},{_id:2,price:199,coins:650},{_id:3,price:299,coins:1e3}],{enqueueSnackbar:i}=f(),{id:y}=g(),u=j(),{user:a}=N(r=>r.auth),o=w(),t=p.find(r=>r._id===Number(y));if(!t)return e.jsx("div",{className:"p-6 text-red-500 text-lg font-semibold",children:"Invalid Coin Pack"});const x=()=>new Promise(r=>{const s=document.createElement("script");s.src="https://checkout.razorpay.com/v1/checkout.js",s.onload=()=>r(!0),document.body.appendChild(s)}),h=async()=>{if(!await x())return alert("Razorpay SDK failed to load");const n=await(await fetch(`${m}/create-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:t.price,coins:t.coins,userId:a==null?void 0:a._id,coinPackId:t._id,email:a==null?void 0:a.email})})).json();if(!n.orderId)return alert("Order creation failed");const b={key:v,amount:t.price*100,currency:"INR",name:"BinaryKeeda Coins",description:`${t.coins} Coins Purchase`,order_id:n.orderId,notes:{userId:a==null?void 0:a._id,coinPackId:t._id,email:a==null?void 0:a.email,coins:t.coins},handler:async function(c){var l;const d=await(await fetch(`${m}/verify-payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:n.orderId,paymentId:c.razorpay_payment_id,razorpaySignature:c.razorpay_signature})})).json();d&&d.success===!0?(i("Payment Successful!",{variant:"success"}),u((l=P)==null?void 0:l()),o("/user")):(i("Payment failed! Signature mismatch.",{variant:"error"}),o("/user"))},prefill:{email:a==null?void 0:a.email},theme:{color:"#111111"}};new window.Razorpay(b).open()};return e.jsxs(e.Fragment,{children:[e.jsx(k,{}),e.jsx("div",{className:"bg-gray-100 pt-10 flex items-center justify-center px-4",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg p-6 border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Checkout"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Review your pack & proceed to payment"}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[t.coins," Coins"]}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Instantly added after successful payment"})]}),e.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["₹",t.price]})]})}),e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Email"}),e.jsx("input",{type:"email",value:(a==null?void 0:a.email)||"",readOnly:!0,className:"border p-3 w-full rounded-lg bg-gray-100 cursor-not-allowed mb-4"}),e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Selected Plan"}),e.jsx("input",{type:"text",value:`${t.coins} Coins — ₹${t.price}`,readOnly:!0,className:"border p-3 w-full rounded-lg bg-gray-100 cursor-not-allowed mb-6"}),e.jsxs("button",{onClick:h,className:"w-full bg-black text-white py-3 rounded-lg text-lg font-semibold hover:bg-gray-900 transition shadow-md",children:["Pay ₹",t.price]}),e.jsx("p",{className:"text-center text-xs text-gray-400 mt-4",children:"Secured by Razorpay"})]})})]})}export{$ as default};
