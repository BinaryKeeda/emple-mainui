const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddCampusTestProblems-CJJv0HqC.js","assets/index-Cnot-2ym.js","assets/index-QIgYHzyf.css","assets/Box-DHF0mKg3.js","assets/extendSxProp-5KrJDvIs.js","assets/Typography-D-fKhgjF.js","assets/index-DRaixxo8.js","assets/TextField-C6pYyRir.js","assets/Select-BzOmGavr.js","assets/Menu-CrTGpRNq.js","assets/index-Bs9ULPWQ.js","assets/useSlotProps-u-_lnTsS.js","assets/Paper-CN-Rk9Xx.js","assets/Grow-CnbYtzHM.js","assets/mergeSlotProps-DX1dMcPb.js","assets/ListItemText-BmBMOJtN.js","assets/MenuItem-B5tNyPk-.js","assets/dividerClasses-BRg5a47u.js","assets/Checkbox-xrwzTrNv.js","assets/SwitchBase-Dwl02ncM.js","assets/Button-DFDiqIY6.js","assets/AddCampusTestQuestionBank-BHWf2T_Z.js","assets/Stack-C_5ZSOLt.js","assets/useThemeProps-CKhJlJwy.js"])))=>i.map(i=>d[i]);
import{i as L,r as l,q as V,j as e,D as B,d as h,B as g,ak as P}from"./index-Cnot-2ym.js";import{A as O}from"./Add-CwNhXc56.js";import{T as x}from"./Typography-D-fKhgjF.js";import{B as c}from"./Button-DFDiqIY6.js";import{T as i}from"./TextField-C6pYyRir.js";import{M as n}from"./MenuItem-B5tNyPk-.js";import{P as R}from"./Paper-CN-Rk9Xx.js";import{A as U,a as W,b as G}from"./AccordionSummary-C26QHqKu.js";import"./index-DRaixxo8.js";import"./extendSxProp-5KrJDvIs.js";import"./Select-BzOmGavr.js";import"./Menu-CrTGpRNq.js";import"./index-Bs9ULPWQ.js";import"./useSlotProps-u-_lnTsS.js";import"./Grow-CnbYtzHM.js";import"./mergeSlotProps-DX1dMcPb.js";import"./dividerClasses-BRg5a47u.js";const H=l.lazy(()=>P(()=>import("./AddCampusTestProblems-CJJv0HqC.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]))),J=l.lazy(()=>P(()=>import("./AddCampusTestQuestionBank-BHWf2T_Z.js"),__vite__mapDeps([21,1,2,3,4,5,6,22,23,7,8,9,10,11,12,13,14,16,17,15,20])));function xe(){var C;const{id:r}=L(),[t,m]=l.useState(null),[Q,M]=l.useState(!0),[y,$]=l.useState(null),q=V(),[s,o]=l.useState({title:"",type:"quiz",maxQuestion:"",maxTime:"",maxScore:"",description:""}),[b,f]=l.useState(!1),[S,N]=l.useState(!1),[E,j]=l.useState(null),[F,v]=l.useState(null),u=async()=>{try{const a=await h.get(`${g}/api/admin/campus/tests/${r}`,{withCredentials:!0});m(a.data.data)}catch{$("Failed to fetch test")}finally{M(!1)}};l.useEffect(()=>{u()},[r]);const D=async()=>{try{f(!0);const a=await h.put(`${g}/api/admin/campus/tests/${r}/sections`,s,{withCredentials:!0});await u(),o({title:"",type:"quiz",maxQuestion:"",maxTime:"",maxScore:"",description:""})}catch(a){console.error("Failed to add section",a),alert("Failed to add section")}finally{f(!1)}},k=async()=>{try{N(!0);const a=await h.put(`${g}/api/admin/campus/tests/update/${r}`,t,{withCredentials:!0});m(a.data.data)}catch(a){console.error("Failed to update test",a),alert("Failed to save changes")}finally{N(!1)}},I=async a=>{if(window.confirm("Are you sure you want to delete this section?"))try{await h.delete(`${g}/api/admin/campus/tests/${r}/sections/${a}`,{withCredentials:!0}),await u()}catch(p){console.error("Failed to delete section",p),alert("Failed to delete section")}};return Q?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(B,{})}):y?e.jsx(x,{color:"error",children:y}):e.jsx("div",{children:e.jsxs("div",{className:"p-6 md:p-10 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("h4",{className:"font-bold mb-2 text-gray-800 text-xl",children:["Edit Test - ",t==null?void 0:t.name]}),e.jsx(c,{onClick:()=>q("/admin/mail/"+r),variant:"contained",children:"Mail Users"})]}),e.jsxs("h3",{className:"mb-4 font-medium",children:["Available for : ",(C=t.groupId)==null?void 0:C.groupName]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsx(i,{size:"small",label:"Test Name",value:(t==null?void 0:t.name)||"",onChange:a=>m({...t,name:a.target.value}),fullWidth:!0}),e.jsxs(i,{select:!0,size:"small",label:"Visibility",value:(t==null?void 0:t.visibility)||"private",onChange:a=>m({...t,visibility:a.target.value}),fullWidth:!0,children:[e.jsx(n,{value:"private",children:"Private"}),e.jsx(n,{value:"public",children:"Public"}),e.jsx(n,{value:"group",children:"Group"})]}),e.jsxs(i,{select:!0,size:"small",label:"Availability",value:t!=null&&t.isAvailable?"true":"false",onChange:a=>m({...t,isAvailable:a.target.value==="true"}),fullWidth:!0,children:[e.jsx(n,{value:"true",children:"Available"}),e.jsx(n,{value:"false",children:"Not Available"})]})]}),e.jsx(c,{variant:"contained",color:"primary",onClick:k,disabled:S,className:"mb-8",children:S?"Saving...":"Save Changes"}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h1",{className:"font-medium mb-2 pl-1 text-gray-700",children:"Add New Section"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(i,{size:"small",label:"Section Title",value:s.title,onChange:a=>o({...s,title:a.target.value})}),e.jsxs(i,{size:"small",select:!0,label:"Type",value:s.type,onChange:a=>o({...s,type:a.target.value}),children:[e.jsx(n,{value:"quiz",children:"Quiz"}),e.jsx(n,{value:"coding",children:"Coding"}),e.jsx(n,{value:"mixed",children:"Mixed"})]}),e.jsx(i,{size:"small",type:"number",label:"Max Questions",value:s.maxQuestion,onChange:a=>o({...s,maxQuestion:Number(a.target.value)})}),e.jsx(i,{size:"small",type:"number",label:"Max Time (min)",value:s.maxTime,onChange:a=>o({...s,maxTime:Number(a.target.value)})}),e.jsx(i,{size:"small",type:"number",label:"Max Score (optional)",value:s.maxScore,onChange:a=>o({...s,maxScore:Number(a.target.value)})}),e.jsx(i,{size:"small",label:"Description (optional)",value:s.description,onChange:a=>o({...s,description:a.target.value})}),e.jsx(c,{variant:"contained",startIcon:e.jsx(O,{}),onClick:D,disabled:b||!s.title||!s.maxQuestion||!s.maxTime,children:b?"Adding...":"Add Section"})]})]}),e.jsx("h2",{className:"font-semibold pl-1 mt-6 mb-4 text-gray-700 text-lg",children:"Sections"}),(t==null?void 0:t.sections.length)===0&&e.jsx("p",{className:"text-gray-500 italic mb-4",children:"No sections added yet."}),t.sections.map((a,A)=>{var p,z,T,w;return e.jsxs(R,{className:"p-4 mb-4 shadow-sm border rounded-lg bg-white",children:[e.jsx(x,{className:"font-semibold text-lg",children:a.title}),e.jsxs(x,{variant:"body2",color:"textSecondary",children:["Type:"," ",a.type==="quiz"?`Quiz Questions ${((p=a.questionSet)==null?void 0:p.length)||0}`:`Coding Problems ${((z=a.problemset)==null?void 0:z.length)||0}`]}),e.jsxs(x,{variant:"body2",children:["Max Questions: ",a.maxQuestion," | Max Time: ",a.maxTime," ","mins"," ",a.maxScore!==void 0&&`| Max Score: ${a.maxScore}`]}),a.description&&e.jsx(x,{variant:"body2",className:"text-gray-600",children:a.description}),e.jsxs("div",{className:"flex flex-col gap-4 mt-4",children:[a.type==="quiz"&&e.jsx(c,{size:"small",variant:"outlined",onClick:()=>v(a._id),children:a.questionPool?"Update Questionpool":"Add Questionpool"}),a.type==="coding"&&e.jsx(c,{size:"small",variant:"outlined",onClick:()=>j(a._id),children:"Add Problems"}),e.jsxs(U,{children:[e.jsx(W,{children:a.type==="quiz"?"View Questions":"View Problems"}),e.jsx(G,{children:a.type==="quiz"?e.jsx(e.Fragment,{children:(T=a==null?void 0:a.questionPool)==null?void 0:T.name}):(w=a.problemPool)!=null&&w.length?e.jsx("ul",{className:"list-disc ml-6 space-y-2 text-sm text-gray-800",children:a.problemPool.map((d,_)=>e.jsxs("li",{children:[e.jsx("strong",{children:d.title||`Problem ${_+1}`}),e.jsx("br",{}),d.difficulty&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"Difficulty:"})," ",d.difficulty,e.jsx("br",{})]}),Array.isArray(d.tags)&&d.tags.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600",children:"Tags:"})," ",d.tags.join(", ")]})]},d._id||_))}):e.jsx("p",{className:"text-gray-500 italic",children:"No problems added yet."})})]})]}),e.jsx(c,{sx:{mt:3},size:"small",color:"error",variant:"outlined",onClick:()=>I(a._id),children:"Delete Section"}),e.jsxs(l.Suspense,{fallback:e.jsx("div",{children:"Loading modal..."}),children:[F===a._id&&a.type==="quiz"&&e.jsx(J,{open:!0,onClose:()=>v(null),testId:r,sectionId:a._id,onSuccess:()=>{u(),v(null)}}),E===a._id&&a.type==="coding"&&e.jsx(H,{open:!0,onClose:()=>j(null),testId:r,sectionId:a._id,onSuccess:()=>{u(),j(null)}})]})]},a._id||A)})]})})}export{xe as default};
