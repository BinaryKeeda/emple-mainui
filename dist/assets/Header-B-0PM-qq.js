import{w as Y,v as ee,r as x,x as re,aF as w,z as te,y as _,j as t,aC as l,A as ae,an as oe,aD as ie,e as ne,d as se,B as le,R as ce,b8 as de,u as ge,c as pe,b as j,o as me,I as S,ak as he,al as ue}from"./index-B_WPkkw_.js";import{u as fe,G as ve}from"./api-BePYVt40.js";import{D as xe}from"./Drawer-CQQgVFQA.js";import{D as A}from"./Divider-DA_4uH1a.js";import{u as be}from"./useQuery-BwqBZpZk.js";import{S as ye,P as Oe}from"./ShortText-BApMEyht.js";import{u as F}from"./usePreviousProps-CF--bwPW.js";function je(r){const{badgeContent:e,invisible:a=!1,max:i=99,showZero:d=!1}=r,c=F({badgeContent:e,max:i});let s=a;a===!1&&e===0&&!d&&(s=!0);const{badgeContent:o,max:n=i}=s?c:r,g=o&&Number(o)>n?`${n}+`:o;return{badgeContent:o,invisible:s,max:n,displayValue:g}}function Ce(r){return ee("MuiBadge",r)}const m=Y("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),C=10,N=4,Ne=r=>{const{color:e,anchorOrigin:a,invisible:i,overlap:d,variant:c,classes:s={}}=r,o={root:["root"],badge:["badge",c,i&&"invisible",`anchorOrigin${l(a.vertical)}${l(a.horizontal)}`,`anchorOrigin${l(a.vertical)}${l(a.horizontal)}${l(d)}`,`overlap${l(d)}`,e!=="default"&&`color${l(e)}`]};return ae(o,Ce,s)},Re=_("span",{name:"MuiBadge",slot:"Root",overridesResolver:(r,e)=>e.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),Pe=_("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(r,e)=>{const{ownerState:a}=r;return[e.badge,e[a.variant],e[`anchorOrigin${l(a.anchorOrigin.vertical)}${l(a.anchorOrigin.horizontal)}${l(a.overlap)}`],a.color!=="default"&&e[`color${l(a.color)}`],a.invisible&&e.invisible]}})(oe(({theme:r})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:r.typography.fontFamily,fontWeight:r.typography.fontWeightMedium,fontSize:r.typography.pxToRem(12),minWidth:C*2,lineHeight:1,padding:"0 6px",height:C*2,borderRadius:C,zIndex:1,transition:r.transitions.create("transform",{easing:r.transitions.easing.easeInOut,duration:r.transitions.duration.enteringScreen}),variants:[...Object.entries(r.palette).filter(ie(["contrastText"])).map(([e])=>({props:{color:e},style:{backgroundColor:(r.vars||r).palette[e].main,color:(r.vars||r).palette[e].contrastText}})),{props:{variant:"dot"},style:{borderRadius:N,height:N*2,minWidth:N*2,padding:0}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${m.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${m.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${m.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${m.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${m.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="right"&&e.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${m.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="top"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${m.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:e})=>e.anchorOrigin.vertical==="bottom"&&e.anchorOrigin.horizontal==="left"&&e.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${m.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:r.transitions.create("transform",{easing:r.transitions.easing.easeInOut,duration:r.transitions.duration.leavingScreen})}}]})));function L(r){return{vertical:(r==null?void 0:r.vertical)??"top",horizontal:(r==null?void 0:r.horizontal)??"right"}}const Be=x.forwardRef(function(e,a){const i=re({props:e,name:"MuiBadge"}),{anchorOrigin:d,className:c,classes:s,component:o,components:n={},componentsProps:g={},children:p,overlap:f="rectangular",color:v="default",invisible:R=!1,max:b=99,badgeContent:P,slots:h,slotProps:u,showZero:B=!1,variant:y="standard",...U}=i,{badgeContent:T,invisible:E,max:M,displayValue:V}=je({max:b,invisible:R,badgeContent:P,showZero:B}),W=F({anchorOrigin:L(d),color:v,overlap:f,variant:y,badgeContent:P}),$=E||T==null&&y!=="dot",{color:q=v,overlap:G=f,anchorOrigin:H,variant:z=y}=$?W:i,Q=L(H),D=z!=="dot"?V:void 0,O={...i,badgeContent:T,invisible:$,max:M,displayValue:D,showZero:B,anchorOrigin:Q,color:q,overlap:G,variant:z},I=Ne(O),k={slots:{root:(h==null?void 0:h.root)??n.Root,badge:(h==null?void 0:h.badge)??n.Badge},slotProps:{root:(u==null?void 0:u.root)??g.root,badge:(u==null?void 0:u.badge)??g.badge}},[K,Z]=w("root",{elementType:Re,externalForwardedProps:{...k,...U},ownerState:O,className:te(I.root,c),ref:a,additionalProps:{as:o}}),[J,X]=w("badge",{elementType:Pe,externalForwardedProps:k,ownerState:O,className:I.badge});return t.jsxs(K,{...Z,children:[p,t.jsx(J,{...X,children:D})]})}),Te=ne(t.jsx("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"}),"Notifications"),$e="#1d1e20",ze=async r=>(await fe.get(ve.GET_USER_INVITE+r)).data,De=({userId:r})=>be({queryKey:["inviteData",r],queryFn:()=>ze(r),onSuccess:(e,a,i)=>{i.queryClient.invalidateQueries(["inviteData",r]),i.queryClient.invalidateQueries(["groupData",r])}});function Ie({notificationOpen:r,setNotificationOpen:e,data:a,userId:i,refreshInvites:d}){var s;const c=async(o,n,g)=>{try{await se.post(le+"/api/data/invites/respond",{inviteId:o,accept:n==="accept",section:g},{withCredentials:!0}),window.location.reload()}catch(p){console.error("Error responding to invite:",p)}};return t.jsx(xe,{anchor:"right",open:r,onClose:()=>e(!1),children:t.jsxs("div",{className:"w-80 p-4",children:[t.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Notifications"}),t.jsx(A,{className:"mb-2"}),t.jsx("ul",{className:"space-y-4 mt-3",children:(s=a==null?void 0:a.data)!=null&&s.length?a.data.map(o=>{var n;return t.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl shadow-sm border",children:[t.jsxs("div",{className:"text-sm",children:[t.jsxs("p",{className:"font-medium",children:[(n=o.invitedBy)==null?void 0:n.name," invited you to join a group"]}),t.jsxs("p",{className:"text-xs text-gray-500",children:["Role: ",o.role," ·"," ",new Date(o.createdAt).toLocaleString()]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>c(o._id,"accept",o.sectionId),className:"px-2 py-1 text-xs rounded-lg bg-green-500 text-white hover:bg-green-600",children:"✅"}),t.jsx("button",{onClick:()=>c(o._id,"reject",o.sectionId),className:"px-2 py-1 text-xs rounded-lg bg-red-500 text-white hover:bg-red-600",children:"❌"})]})]},o._id)}):t.jsx("li",{className:"text-sm text-gray-500",children:"No pending invites"})})]})})}const Ue=ce.memo(({user:r,menuOpen:e,setMenuOpen:a})=>{const{toggleTheme:i,theme:d}=x.useContext(de),c=ge(),[s,o]=x.useState(!1),[n,g]=x.useState(0),{data:p}=De(r?{userId:r._id}:{}),f=()=>{try{c(he(ue.get("token")))}catch(b){console.log(b,"logout")}},v=()=>{o(!0),g(0)},{enqueueSnackbar:R}=pe();return t.jsxs(t.Fragment,{children:[t.jsx("header",{className:"relative h-[59px]",children:t.jsxs("nav",{className:`fixed shadow-sm bg-white dark:bg-support dark:text-gray-50 bg-blend-difference text-gray-600 h-[59px] items-center pr-5 pl-2 flex justify-between z-40 w-full top-0 dark:bg-[${$e}]`,children:[t.jsx("div",{className:"lg:hidden",children:t.jsx(ye,{onClick:()=>a(!e)})}),t.jsx("div",{className:"flex md:ml-[100px] gap-1 items-center",children:t.jsx(j,{to:"/",children:t.jsx("img",{src:me,className:"h-10",alt:"Logo"})})}),t.jsx("div",{className:"flex items-center gap-3",children:r?t.jsxs(t.Fragment,{children:[t.jsx(S,{"aria-label":"notifications",onClick:v,children:t.jsxs(Be,{badgeContent:n,color:"error",sx:{position:"relative"},overlap:"circular",children:[t.jsx(Te,{}),t.jsx("span",{className:"text-xs bg-red-500 text-white -right-2  h-4 rounded-full absolute w-4",children:JSON.stringify(p==null?void 0:p.data.length)||0})]})}),t.jsx(S,{onClick:f,children:t.jsx(Oe,{})})]}):t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx(j,{to:"/login",className:"text-sm font-medium hover:underline",children:"Login"}),t.jsx(A,{orientation:"vertical",flexItem:!0,sx:{bgcolor:"grey.500"}}),t.jsx(j,{to:"/register",className:"text-sm font-medium hover:underline",children:"Signup"})]})})]})}),t.jsx(Ie,{data:p,userId:r==null?void 0:r._id,notificationOpen:s,setNotificationOpen:o})]})});export{Ue as H};
