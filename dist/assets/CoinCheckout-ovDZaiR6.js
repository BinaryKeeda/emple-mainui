import{c as b,i as g,u as j,a as w,q as N,j as e,c8 as m,c9 as v}from"./index-GnGT0G9-.js";import{G as P}from"./Breadcrumb-D35BCm55.js";import"./useSlotProps-DQsF1HqT.js";import"./Typography-C7dIrPx2.js";import"./index-DZ_2OE68.js";import"./extendSxProp-CoD2AlFp.js";import"./Box-DPTdvBH4.js";function $(){const p=[{_id:1,price:99,coins:300},{_id:2,price:199,coins:650},{_id:3,price:299,coins:1e3}],{enqueueSnackbar:i}=b(),{id:y}=g(),u=j(),{user:t}=w(r=>r.auth),o=N(),a=p.find(r=>r._id===Number(y));if(!a)return e.jsx("div",{className:"p-6 text-red-500 text-lg font-semibold",children:"Invalid Coin Pack"});const x=()=>new Promise(r=>{const s=document.createElement("script");s.src="https://checkout.razorpay.com/v1/checkout.js",s.onload=()=>r(!0),document.body.appendChild(s)}),h=async()=>{if(!await x())return alert("Razorpay SDK failed to load");const n=await(await fetch(`${m}/create-order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:a.price,coins:a.coins,userId:t==null?void 0:t._id,coinPackId:a._id,email:t==null?void 0:t.email})})).json();if(!n.orderId)return alert("Order creation failed");const f={key:"rzp_test_RGIjVTm6peDV3h",amount:a.price*100,currency:"INR",name:"BinaryKeeda Coins",description:`${a.coins} Coins Purchase`,order_id:n.orderId,notes:{userId:t==null?void 0:t._id,coinPackId:a._id,email:t==null?void 0:t.email,coins:a.coins},handler:async function(c){var l;const d=await(await fetch(`${m}/verify-payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:n.orderId,paymentId:c.razorpay_payment_id,razorpaySignature:c.razorpay_signature})})).json();d&&d.success===!0?(i("Payment Successful!",{variant:"success"}),u((l=v)==null?void 0:l()),o("/user")):(i("Payment failed! Signature mismatch.",{variant:"error"}),o("/user"))},prefill:{email:t==null?void 0:t.email},theme:{color:"#111111"}};new window.Razorpay(f).open()};return e.jsxs(e.Fragment,{children:[e.jsx(P,{}),e.jsx("div",{className:"bg-gray-100 pt-10 flex items-center justify-center px-4",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl shadow-lg p-6 border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Checkout"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Review your pack & proceed to payment"}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[a.coins," Coins"]}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Instantly added after successful payment"})]}),e.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["₹",a.price]})]})}),e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Email"}),e.jsx("input",{type:"email",value:(t==null?void 0:t.email)||"",readOnly:!0,className:"border p-3 w-full rounded-lg bg-gray-100 cursor-not-allowed mb-4"}),e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Selected Plan"}),e.jsx("input",{type:"text",value:`${a.coins} Coins — ₹${a.price}`,readOnly:!0,className:"border p-3 w-full rounded-lg bg-gray-100 cursor-not-allowed mb-6"}),e.jsxs("button",{onClick:h,className:"w-full bg-black text-white py-3 rounded-lg text-lg font-semibold hover:bg-gray-900 transition shadow-md",children:["Pay ₹",a.price]}),e.jsx("p",{className:"text-center text-xs text-gray-400 mt-4",children:"Secured by Razorpay"})]})})]})}export{$ as default};
