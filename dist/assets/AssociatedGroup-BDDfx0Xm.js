import{r as y,j as e,d as v,B as w,a as S,i as z,aj as C,b as q}from"./index-Cnot-2ym.js";import{a as L}from"./useGroupData-CvsHKgHp.js";import{u as k}from"./useQuery-D254Y5GB.js";import{L as P}from"./Lock-6vNJaIw1.js";import"./api-D91yA4HL.js";function A({sectionId:d,isGroup:m=!1}){const[s,o]=y.useState(1),i=10,b=y.useMemo(()=>({sectionId:d,isGroup:m,page:s,limit:i}),[d,m,s,i]),x=async({queryKey:a})=>{const[N,n]=a,f=new URLSearchParams(n).toString();return(await v.get(`${w}/api/data/user/quiz?${f}`,{withCredentials:!0})).data},{data:t,isLoading:h,isError:p,error:g}=k({queryKey:["quizzes",b],queryFn:x,keepPreviousData:!0,staleTime:1e3*60*5});if(h)return e.jsx("div",{children:"Loading quizzes..."});if(p)return e.jsx("div",{className:"text-red-500",children:g.message});const j=(t==null?void 0:t.quizzes)||[],l=(t==null?void 0:t.total)||0,c=Math.ceil(l/i),u=()=>{s>1&&o(s-1)},r=()=>{s<c&&o(s+1)};return e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"relative px-5 md:px-4 flex flex-col w-full overflow-x-auto dark:text-white bg-white shadow-md rounded-lg",children:[e.jsxs("table",{className:"w-full text-left table-auto min-w-max",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-white",children:[e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Title"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Difficulty"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Category"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Marks"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Attempt"})]})}),e.jsx("tbody",{children:j.map(a=>e.jsxs("tr",{className:"bg-primary",children:[e.jsx("td",{className:"p-4",children:a.title}),e.jsx("td",{className:"p-4",children:a.difficulty}),e.jsx("td",{className:"p-4",children:a.category}),e.jsx("td",{className:"p-4",children:a.marks}),e.jsx("td",{className:"p-4",children:a.locked?e.jsx(P,{}):e.jsx("a",{href:`/user/quiz/${a.slug}`,className:"text-xs bg-sky-600 hover:bg-sky-500 text-white py-1 px-3 rounded-full",children:"Attempt"})})]},a._id))})]}),l>i&&e.jsxs("div",{className:"flex bg-support justify-between items-center px-4 py-3",children:[e.jsxs("div",{className:"text-sm",children:["Showing ",e.jsxs("b",{children:[(s-1)*i+1,"-",Math.min(s*i,l)]})," of ",l]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:u,disabled:s===1,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal bg-primary border border-slate-200 rounded hover:border-slate-400 disabled:opacity-50",children:"Prev"}),e.jsx("button",{onClick:r,disabled:s===c,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal bg-primary border border-slate-200 rounded hover:border-slate-400 disabled:opacity-50",children:"Next"})]})]})]})})}function M({sectionId:d,isGroup:m=!1}){const[s,o]=y.useState(1),i=10,b=y.useMemo(()=>({sectionId:d,page:s,limit:i,isGroup:m}),[d,s,i]),x=async({queryKey:a})=>{const[N,n]=a,f=new URLSearchParams(n).toString();return(await v.get(`${w}/api/data/user/test?${f}`,{withCredentials:!0})).data},{data:t,isLoading:h,isError:p,error:g}=k({queryKey:["tests",b],queryFn:x,keepPreviousData:!0,staleTime:1e3*60*5});if(h)return e.jsx("div",{children:"Loading tests..."});if(p)return e.jsx("div",{className:"text-red-500",children:g.message});const j=(t==null?void 0:t.tests)||[],l=(t==null?void 0:t.total)||0,c=Math.ceil(l/i),u=()=>{s>1&&o(s-1)},r=()=>{s<c&&o(s+1)};return e.jsx("div",{className:"",children:e.jsxs("div",{className:"relative flex flex-col w-full overflow-x-auto dark:text-white bg-white shadow-md rounded-lg",children:[e.jsxs("table",{className:"w-full   min-w-max",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-whitw",children:[e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Title"}),e.jsx("th",{className:"p-4 border-b border-slate-200",children:"Attempt"})]})}),e.jsx("tbody",{children:j.map(a=>e.jsxs("tr",{className:"bg-white",children:[e.jsx("td",{className:"p-4 text-center ",children:a.name}),e.jsx("td",{className:"p-4 text-center",children:a.locked===!1?e.jsx("a",{href:`/user/exam/${a==null?void 0:a._id}`,className:"text-xs bg-sky-600 hover:bg-sky-500 text-white py-1 px-3 rounded-full",children:"Attempt"}):e.jsx(P,{})})]},a._id))})]}),l>i&&e.jsxs("div",{className:"flex bg-support justify-between items-center px-4 py-3",children:[e.jsxs("div",{className:"text-sm",children:["Showing"," ",e.jsxs("b",{children:[(s-1)*i+1,"-",Math.min(s*i,l)]})," ","of ",l]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:u,disabled:s===1,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal bg-primary border border-slate-200 rounded hover:border-slate-400 disabled:opacity-50",children:"Prev"}),e.jsx("button",{onClick:r,disabled:s===c,className:"px-3 py-1 min-w-9 min-h-9 text-sm font-normal bg-primary border border-slate-200 rounded hover:border-slate-400 disabled:opacity-50",children:"Next"})]})]})]})})}function F(){var l,c,u;const{user:d}=S(r=>r.auth),m=d._id,{id:s}=z(),[o,i]=C(),b=o.get("section"),x=o.get("tab"),{data:t,error:h}=L({userId:m,id:s});if(h)return e.jsx("div",{className:"flex h-[60vh] items-center justify-center",children:e.jsxs("p",{className:"text-red-600 font-medium",children:["Error loading sections: ",JSON.stringify(h)]})});if(!t)return e.jsx("div",{className:"flex h-[60vh] items-center justify-center",children:e.jsx("div",{className:"animate-pulse text-gray-500",children:"Loading sections..."})});const p=(c=(l=t==null?void 0:t.data)==null?void 0:l.find(r=>r.section._id===b))==null?void 0:c.section,g=({section:r})=>e.jsxs(q,{to:`?section=${r._id}`,className:`
        group relative bg-white border border-gray-200 
        rounded-2xl shadow-sm hover:shadow-md hover:-translate-y-1
        transition-all duration-300 overflow-hidden
      `,children:[e.jsx("img",{src:r.logo,alt:r.name,className:"h-40 w-full object-cover opacity-95 group-hover:opacity-100 transition-all"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1 truncate",children:r.name}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Click to explore"})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-white/60 to-transparent opacity-0 group-hover:opacity-100 transition-all"})]}),j=({section:r})=>{const a=[{head:"Quiz",type:"quiz",image:r.quizImage||"https://res.cloudinary.com/drzyrq7d5/image/upload/v1757593501/quiz_ptz1ft.png"},{head:"Test Series",type:"test",image:r.testImage||"https://res.cloudinary.com/dkybjjott/image/upload/v1750263010/WhatsApp_Image_2025-06-11_at_21.12.06-removebg-preview_losyhk.png"}],N=n=>{i({section:r._id,tab:n})};return x==="quiz"?e.jsx(A,{sectionId:r._id,isGroup:!0}):x==="test"?e.jsx(M,{sectionId:r._id,isGroup:!0}):e.jsx("div",{className:"flex px-5  gap-8 py-6",children:a.map((n,f)=>e.jsxs("div",{onClick:()=>N(n.type),className:`
              cursor-pointer flex flex-col items-center
              bg-white rounded-2xl border border-gray-200
              shadow-sm hover:shadow-md hover:-translate-y-1
              transition-all duration-300 overflow-hidden
              w-80
            `,children:[e.jsx("img",{src:n.image,alt:n.head,className:"h-52 w-full object-contain  p-4"}),e.jsxs("div",{className:"flex flex-col items-center justify-center p-4 w-full",children:[e.jsx("hr",{className:"w-2/3 border-gray-200 mb-3"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 tracking-wide",children:n.head}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Click to view ",n.head.toLowerCase()]})]})]},f))})};return e.jsx("div",{className:"min-h-screen",children:p?e.jsx(e.Fragment,{children:e.jsx(j,{section:p})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:(u=t==null?void 0:t.data)==null?void 0:u.map(r=>e.jsx(g,{section:r.section},r.section._id))})})})}export{F as default};
